<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marais | A New Orleans Art House</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;0,600;1,300;1,400&family=Montserrat:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="https://js.stripe.com/v3/"></script>
</head>
<body>
    <!-- Loading Screen -->
    <div class="loader" id="loader">
        <div class="loader-content">
            <span class="loader-location">New Orleans</span>
            <h1 class="loader-title">Marais</h1>
            <div class="loader-line"></div>
        </div>
    </div>

    <!-- Image Lightbox -->
    <div class="lightbox" id="lightbox">
        <button class="lightbox-close" id="lightbox-close">&times;</button>
        <button class="lightbox-prev" id="lightbox-prev">&#8249;</button>
        <button class="lightbox-next" id="lightbox-next">&#8250;</button>
        <div class="lightbox-content">
            <img src="" alt="" id="lightbox-img">
        </div>
    </div>

    <!-- Events Ticker -->
    <div class="events-ticker" id="events-ticker">
        <div class="ticker-track" id="ticker-track"></div>
    </div>

    <!-- Minimal Navigation - Appears on scroll -->
    <nav class="nav-minimal" id="nav">
        <a href="#" class="nav-logo">Marais</a>
        <div class="nav-right">
            <a href="#book" class="nav-book-btn">Reserve</a>
        </div>
    </nav>

    <!-- Scene 1: The Invitation -->
    <section class="scene scene-invitation" id="home">
        <div class="invitation-bg">
            <div class="invitation-overlay"></div>
        </div>
        <div class="invitation-content">
            <span class="invitation-location">New Orleans, Louisiana</span>
            <h1 class="invitation-title">Marais</h1>
            <p class="invitation-subtitle">Where Art Lives</p>
            <div class="invitation-scroll">
                <div class="scroll-arrow"></div>
            </div>
        </div>
    </section>

    <!-- Scene 2: Book Your Stay -->
    <section class="scene scene-book" id="book">
        <div class="book-container">
            <div class="book-intro">
                <span class="scene-label">Your Stay</span>
                <h2>Ready to experience Marais?</h2>
                <p>Select your dates and we'll show you the rest.</p>
            </div>

            <div class="book-widget">
                <div class="book-card">
                    <!-- Hidden inputs for date storage -->
                    <input type="hidden" id="check-in" name="check-in">
                    <input type="hidden" id="check-out" name="check-out">

                    <!-- NOLA Events Calendar -->
                    <div class="nola-calendar" id="calendar-container">
                        <!-- Featured Events Marquee -->
                        <div class="events-marquee">
                            <div class="marquee-label">What's Happening</div>
                            <div class="marquee-events" id="marquee-events"></div>
                        </div>

                        <!-- Calendar Grid -->
                        <div class="calendar-grid-section">
                            <div class="calendar-nav-row">
                                <button type="button" class="cal-arrow" id="cal-prev">‚Üê</button>
                                <span class="calendar-month-title" id="calendar-title-1"></span>
                                <button type="button" class="cal-arrow" id="cal-next">‚Üí</button>
                            </div>

                            <div class="calendar-weekdays">
                                <span>S</span><span>M</span><span>T</span><span>W</span><span>T</span><span>F</span><span>S</span>
                            </div>
                            <div class="calendar-days" id="calendar-days-1"></div>
                        </div>

                        <!-- Selection Bar -->
                        <div class="selection-bar">
                            <div class="guest-picker">
                                <select id="guests" name="guests">
                                    <option value="1">1 Guest</option>
                                    <option value="2" selected>2 Guests</option>
                                    <option value="3">3 Guests</option>
                                    <option value="4">4 Guests</option>
                                    <option value="5">5 Guests</option>
                                    <option value="6">6 Guests</option>
                                    <option value="7">7 Guests</option>
                                    <option value="8">8 Guests</option>
                                    <option value="9">9 Guests</option>
                                    <option value="10">10 Guests</option>
                                </select>
                            </div>
                            <button type="button" id="check-prices-btn" class="btn-check-prices">
                                Check Prices
                            </button>
                        </div>
                    </div>

                </div>
            </div>

            <!-- Your Stay Info Panel (appears after date selection) -->
            <div class="stay-info-panel hidden" id="stay-info-panel">
                <h3>Your New Orleans Stay</h3>

                <!-- Weather -->
                <div class="stay-section">
                    <div class="stay-section-header">
                        <span class="stay-icon">‚òÄÔ∏è</span>
                        <h4>Weather</h4>
                    </div>
                    <p class="stay-weather" id="stay-weather">Expect mild temperatures around 65¬∞F with occasional rain.</p>
                </div>

                <!-- Events During Stay -->
                <div class="stay-section">
                    <div class="stay-section-header">
                        <span class="stay-icon">üé≠</span>
                        <h4>Events During Your Stay</h4>
                    </div>
                    <div class="stay-events" id="stay-events">
                        <p class="no-events-msg">No major events during these dates</p>
                    </div>
                </div>

                <!-- Recommendations -->
                <div class="stay-section">
                    <div class="stay-section-header">
                        <span class="stay-icon">‚ú®</span>
                        <h4>Don't Miss</h4>
                    </div>
                    <div class="stay-recommendations" id="stay-recommendations">
                        <div class="recommendation-item">
                            <strong>Bacchanal Wine</strong>
                            <span>Live jazz in the backyard, 10 min away</span>
                        </div>
                        <div class="recommendation-item">
                            <strong>Commander's Palace</strong>
                            <span>Iconic NOLA fine dining, 5 min away</span>
                        </div>
                        <div class="recommendation-item">
                            <strong>Magazine Street</strong>
                            <span>Shopping & restaurants, 2 min walk</span>
                        </div>
                    </div>
                </div>

                <!-- Add-ons Preview -->
                <div class="stay-section">
                    <div class="stay-section-header">
                        <span class="stay-icon">üéÅ</span>
                        <h4>Enhance Your Stay</h4>
                    </div>
                    <p class="stay-addons-hint">Add services like cold plunge, private chef, or early check-in during checkout.</p>
                </div>
            </div>

        </div>
    </section>

    <!-- Scene 3: The Art - Egret Reveal -->
    <section class="scene scene-art" id="art">
        <div class="art-container">
            <div class="art-frame">
                <img src="Copy of 1.jpg" alt="Louisiana Egret" class="art-image">
            </div>
            <div class="art-text">
                <span class="scene-label">The Art</span>
                <h2>Every wall tells a story</h2>
                <p>Original Louisiana artwork adorns this home‚Äîfrom the hand-painted egret watching over the living room to murals of moss-draped oaks. This isn't a rental. It's a gallery you can sleep in.</p>
            </div>
        </div>
    </section>

    <!-- Scene 4: The Space - Living Areas -->
    <section class="scene scene-space" id="space">
        <div class="space-gallery">
            <div class="space-image space-image-main">
                <img src="Copy of 3.jpg" alt="Living Space" loading="lazy">
            </div>
            <div class="space-image space-image-secondary">
                <img src="Copy of 6.jpg" alt="Interior Detail" loading="lazy">
            </div>
        </div>
        <div class="space-content">
            <span class="scene-label">The Space</span>
            <h2>Five bedrooms.<br>Endless light.</h2>
            <p>Soaring ceilings, walls of glass, and a layout designed for gathering. Modern architecture meets Southern warmth‚Äîevery corner invites you to stay a while.</p>
        </div>
    </section>

    <!-- Scene 5: The Water - Pool Paradise -->
    <section class="scene scene-water" id="water">
        <div class="water-bg">
            <img src="Copy of 50.jpg" alt="Pool" loading="lazy">
        </div>
        <div class="water-overlay"></div>
        <div class="water-content">
            <span class="scene-label">The Water</span>
            <h2>Your private paradise</h2>
            <p>A heated pool for every season. A tiki bar for every mood. Tropical gardens, outdoor speakers, and evenings that stretch into New Orleans nights.</p>
        </div>
    </section>

    <!-- Scene 6: The Layout - Floor Plan -->
    <section class="scene scene-layout" id="layout">
        <div class="layout-container">
            <div class="layout-text">
                <span class="scene-label">The Layout</span>
                <h2>Room to roam</h2>
                <p>Two floors of thoughtfully designed space. Five bedrooms with king and queen beds, open living areas, and seamless flow between indoors and out.</p>
            </div>
            <div class="layout-image">
                <img src="2300 floor sketch.jpg" alt="Floor Plan" loading="lazy">
            </div>
        </div>
    </section>

    <!-- Scene 7: The Details - Horizontal Scroll -->
    <section class="scene scene-details" id="details">
        <div class="details-header">
            <span class="scene-label">The Details</span>
            <h2>Everything you need, nothing you don't</h2>
        </div>
        <div class="details-scroll-container">
            <div class="details-track">
                <div class="detail-card">
                    <div class="detail-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <path d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
                        </svg>
                    </div>
                    <h3>5 Bedrooms</h3>
                    <p>King beds, luxury linens, room to breathe</p>
                </div>
                <div class="detail-card">
                    <div class="detail-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/>
                        </svg>
                    </div>
                    <h3>Heated Pool</h3>
                    <p>Year-round swimming under Louisiana skies</p>
                </div>
                <div class="detail-card">
                    <div class="detail-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <path d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"/>
                        </svg>
                    </div>
                    <h3>Indoor/Outdoor Sound</h3>
                    <p>Speakers throughout for your soundtrack</p>
                </div>
                <div class="detail-card">
                    <div class="detail-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <path d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                        </svg>
                    </div>
                    <h3>Sleeps 10</h3>
                    <p>Gather the whole crew</p>
                </div>
                <div class="detail-card">
                    <div class="detail-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <path d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707"/>
                            <circle cx="12" cy="12" r="4"/>
                        </svg>
                    </div>
                    <h3>Tiki Bar</h3>
                    <p>Mix drinks, make memories</p>
                </div>
                <div class="detail-card">
                    <div class="detail-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <rect x="2" y="7" width="20" height="14" rx="2"/>
                            <path d="M16 7V5a2 2 0 00-2-2h-4a2 2 0 00-2 2v2"/>
                        </svg>
                    </div>
                    <h3>Work-Ready</h3>
                    <p>Fast WiFi, dedicated workspace</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Scene 8: The Neighborhood -->
    <section class="scene scene-neighborhood" id="neighborhood">
        <div class="neighborhood-grid">
            <div class="neighborhood-image">
                <img src="nola-magazine.jpg" alt="Magazine Street" loading="lazy">
            </div>
            <div class="neighborhood-content">
                <span class="scene-label">The Neighborhood</span>
                <h2>Steps from Magazine Street</h2>
                <p>You're in the Irish Channel‚Äîone of New Orleans' most vibrant neighborhoods. Walk to world-class restaurants, dive bars, antique shops, and live music. The French Quarter is a short streetcar ride away.</p>
                <div class="neighborhood-highlights">
                    <div class="highlight">
                        <span class="highlight-distance">2 min walk</span>
                        <span class="highlight-name">Magazine Street</span>
                    </div>
                    <div class="highlight">
                        <span class="highlight-distance">10 min</span>
                        <span class="highlight-name">Garden District</span>
                    </div>
                    <div class="highlight">
                        <span class="highlight-distance">15 min</span>
                        <span class="highlight-name">French Quarter</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Scene 9: The Gallery - More Images -->
    <section class="scene scene-gallery" id="gallery">
        <div class="gallery-header">
            <span class="scene-label">The Gallery</span>
            <h2>See more</h2>
        </div>
        <div class="gallery-mosaic">
            <div class="mosaic-item mosaic-large">
                <img src="Copy of 45.jpg" alt="Pool deck" loading="lazy">
            </div>
            <div class="mosaic-item">
                <img src="Copy of 10.jpg" alt="Bedroom" loading="lazy">
            </div>
            <div class="mosaic-item">
                <img src="Copy of 17.jpg" alt="Kitchen" loading="lazy">
            </div>
            <div class="mosaic-item mosaic-tall">
                <img src="Copy of 21.jpg" alt="Bathroom" loading="lazy">
            </div>
            <div class="mosaic-item">
                <img src="Copy of 35.jpg" alt="Outdoor" loading="lazy">
            </div>
            <div class="mosaic-item mosaic-wide">
                <img src="Copy of 40.jpg" alt="Evening" loading="lazy">
            </div>
            <div class="mosaic-item">
                <img src="Copy of 28.jpg" alt="Detail" loading="lazy">
            </div>
            <div class="mosaic-item">
                <img src="Copy of 32.jpg" alt="Living" loading="lazy">
            </div>
        </div>
    </section>

    <!-- Scene 10: Guest Reviews -->
    <section class="scene scene-reviews" id="reviews">
        <div class="reviews-container">
            <div class="reviews-header">
                <span class="scene-label">Guest Stories</span>
                <h2>What people are saying</h2>
            </div>
            <div class="reviews-grid">
                <div class="review-card">
                    <div class="review-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
                    <p class="review-text">"Absolutely stunning home. The artwork throughout made it feel like staying in a gallery. The pool was perfect and Magazine Street is right there. We didn't want to leave."</p>
                    <div class="review-author">
                        <span class="review-name">Sarah M.</span>
                        <span class="review-date">October 2024</span>
                    </div>
                </div>
                <div class="review-card">
                    <div class="review-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
                    <p class="review-text">"Best Airbnb we've ever stayed in. The space is incredible - those high ceilings and the indoor/outdoor flow. Had 8 people and everyone had room to spread out. The tiki bar was a hit!"</p>
                    <div class="review-author">
                        <span class="review-name">James & Co.</span>
                        <span class="review-date">September 2024</span>
                    </div>
                </div>
                <div class="review-card">
                    <div class="review-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
                    <p class="review-text">"We came for Jazz Fest and this was the perfect home base. The neighborhood is wonderful - walkable to so much. The heated pool after long festival days was everything."</p>
                    <div class="review-author">
                        <span class="review-name">The Wilsons</span>
                        <span class="review-date">May 2024</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Checkout Section -->
    <section class="scene scene-checkout hidden" id="checkout-section">
        <div class="checkout-container" id="checkout-container">
            <div class="checkout-card" id="checkout-card">
                <h3>Complete Your Reservation</h3>
                <div class="checkout-summary" id="checkout-summary"></div>

                <form id="checkout-form">
                    <div class="form-row">
                        <div class="form-field">
                            <label for="guest-first-name">First Name</label>
                            <input type="text" id="guest-first-name" required>
                        </div>
                        <div class="form-field">
                            <label for="guest-last-name">Last Name</label>
                            <input type="text" id="guest-last-name" required>
                        </div>
                    </div>
                    <div class="form-field">
                        <label for="guest-email">Email</label>
                        <input type="email" id="guest-email" required>
                    </div>
                    <div class="form-field">
                        <label for="guest-phone">Phone</label>
                        <input type="tel" id="guest-phone">
                    </div>

                    <!-- Add-on Services -->
                    <div class="addons-section">
                        <label class="addons-label">Enhance Your Stay</label>
                        <div class="addon-options">
                            <label class="addon-item">
                                <input type="checkbox" id="addon-coldplunge" data-price="150" data-name="Cold Plunge">
                                <div class="addon-info">
                                    <span class="addon-name">Cold Plunge</span>
                                    <span class="addon-desc">Portable ice bath delivered to the property</span>
                                </div>
                                <span class="addon-price">+$150</span>
                            </label>
                            <label class="addon-item">
                                <input type="checkbox" id="addon-chef" data-price="350" data-name="Private Chef">
                                <div class="addon-info">
                                    <span class="addon-name">Private Chef</span>
                                    <span class="addon-desc">One dinner for up to 10 guests</span>
                                </div>
                                <span class="addon-price">+$350</span>
                            </label>
                            <label class="addon-item">
                                <input type="checkbox" id="addon-massage" data-price="200" data-name="In-Home Massage">
                                <div class="addon-info">
                                    <span class="addon-name">In-Home Massage</span>
                                    <span class="addon-desc">Licensed massage therapist (60 min)</span>
                                </div>
                                <span class="addon-price">+$200</span>
                            </label>
                            <label class="addon-item">
                                <input type="checkbox" id="addon-earlycheck" data-price="100" data-name="Early Check-in">
                                <div class="addon-info">
                                    <span class="addon-name">Early Check-in</span>
                                    <span class="addon-desc">Check in at 12pm instead of 4pm</span>
                                </div>
                                <span class="addon-price">+$100</span>
                            </label>
                        </div>
                        <div class="addons-total hidden" id="addons-total">
                            <span>Add-ons:</span>
                            <span id="addons-total-amount">$0</span>
                        </div>
                    </div>

                    <div class="form-field">
                        <label>Card Details</label>
                        <div id="card-element"></div>
                        <div id="card-errors" class="card-errors"></div>
                    </div>

                    <label class="checkbox-label">
                        <input type="checkbox" id="accept-terms" required>
                        <span>I agree to the <a href="#" target="_blank">terms</a> and <a href="#" target="_blank">cancellation policy</a></span>
                    </label>

                    <button type="submit" id="submit-booking" class="btn-submit-booking">
                        Confirm Reservation
                    </button>
                </form>
            </div>
        </div>

        <!-- Booking Confirmation (Hidden by default) -->
        <div class="booking-confirmation hidden" id="booking-confirmation">
            <div class="confirmation-icon">‚úì</div>
            <h3>You're all set</h3>
            <p>Confirmation details have been sent to your email.</p>
            <div class="confirmation-details" id="confirmation-details"></div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-brand">
                <span class="footer-logo">Marais</span>
                <p>A New Orleans Art House</p>
            </div>
            <div class="footer-links">
                <a href="#art">The Art</a>
                <a href="#space">The Space</a>
                <a href="#water">The Water</a>
                <a href="#neighborhood">Neighborhood</a>
                <a href="#book">Book</a>
            </div>
            <div class="footer-contact">
                <p>New Orleans, Louisiana</p>
                <p>Irish Channel</p>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2025 Marais. All rights reserved.</p>
        </div>
    </footer>

    <!-- Quote Display - Fixed Bottom Banner (outside all containers for proper fixed positioning) -->
    <div class="quote-display hidden" id="quote-display">
        <div class="quote-loading" id="quote-loading">
            <div class="loading-spinner"></div>
            <span>Finding your rate...</span>
        </div>
        <div class="quote-result hidden" id="quote-result">
            <div class="quote-summary">
                <div class="quote-dates" id="quote-dates"></div>
                <div class="quote-price">
                    <span class="price-total" id="quote-total"></span>
                    <span class="price-breakdown" id="quote-breakdown"></span>
                    <span class="price-per-guest" id="quote-per-guest"></span>
                </div>
            </div>
        </div>
        <div class="quote-error hidden" id="quote-error">
            <p id="quote-error-message"></p>
        </div>
    </div>

    <script>
        // ============================================
        // LOADING SCREEN
        // ============================================
        // Loading screen with 2 second branding moment
        const loader = document.getElementById('loader');
        const hideLoader = () => {
            loader.classList.add('loaded');
            document.body.classList.add('page-loaded');
        };

        setTimeout(hideLoader, 2000);

        // ============================================
        // LIGHTBOX
        // ============================================
        const lightbox = document.getElementById('lightbox');
        const lightboxImg = document.getElementById('lightbox-img');
        const lightboxClose = document.getElementById('lightbox-close');
        const lightboxPrev = document.getElementById('lightbox-prev');
        const lightboxNext = document.getElementById('lightbox-next');
        let currentImageIndex = 0;
        let galleryImages = [];

        // Collect all gallery images
        document.querySelectorAll('.gallery-mosaic .mosaic-item img, .space-image img').forEach((img, index) => {
            galleryImages.push(img.src);
            img.style.cursor = 'pointer';
            img.addEventListener('click', () => {
                currentImageIndex = index;
                openLightbox(img.src);
            });
        });

        function openLightbox(src) {
            lightboxImg.src = src;
            lightbox.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeLightbox() {
            lightbox.classList.remove('active');
            document.body.style.overflow = '';
        }

        function showPrevImage() {
            currentImageIndex = (currentImageIndex - 1 + galleryImages.length) % galleryImages.length;
            lightboxImg.src = galleryImages[currentImageIndex];
        }

        function showNextImage() {
            currentImageIndex = (currentImageIndex + 1) % galleryImages.length;
            lightboxImg.src = galleryImages[currentImageIndex];
        }

        lightboxClose.addEventListener('click', closeLightbox);
        lightboxPrev.addEventListener('click', showPrevImage);
        lightboxNext.addEventListener('click', showNextImage);
        lightbox.addEventListener('click', (e) => {
            if (e.target === lightbox) closeLightbox();
        });

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (!lightbox.classList.contains('active')) return;
            if (e.key === 'Escape') closeLightbox();
            if (e.key === 'ArrowLeft') showPrevImage();
            if (e.key === 'ArrowRight') showNextImage();
        });

        // ============================================
        // NAVIGATION
        // ============================================
        const nav = document.getElementById('nav');
        let lastScroll = 0;

        window.addEventListener('scroll', () => {
            const currentScroll = window.pageYOffset;

            // Show nav after scrolling past first scene
            if (currentScroll > window.innerHeight * 0.5) {
                nav.classList.add('visible');
            } else {
                nav.classList.remove('visible');
            }

            lastScroll = currentScroll;
        });

        // ============================================
        // SCROLL ANIMATIONS
        // ============================================
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -10% 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('in-view');
                }
            });
        }, observerOptions);

        // Observe all scenes and animated elements
        document.querySelectorAll('.scene, .animate-in').forEach(el => {
            observer.observe(el);
        });

        // ============================================
        // SMOOTH SCROLL FOR ANCHOR LINKS
        // ============================================
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth' });
                }
            });
        });

        // ============================================
        // HORIZONTAL SCROLL FOR DETAILS
        // ============================================
        const detailsSection = document.querySelector('.scene-details');
        const detailsTrack = document.querySelector('.details-track');

        if (detailsSection && detailsTrack) {
            // Add horizontal scroll on wheel in details section
            detailsSection.addEventListener('wheel', (e) => {
                if (Math.abs(e.deltaY) > Math.abs(e.deltaX)) {
                    const container = document.querySelector('.details-scroll-container');
                    container.scrollLeft += e.deltaY;
                }
            }, { passive: true });
        }

        // ============================================
        // NEW ORLEANS EVENTS & FESTIVALS
        // ============================================
        const nolaEvents = [
            // =============================================
            // 2025 EVENTS
            // =============================================

            // JANUARY 2025
            { start: '2025-01-06', end: '2025-01-06', name: 'King Cake Season Begins', type: 'event' },
            { start: '2025-01-11', end: '2025-01-11', name: 'Phunny Phorty Phellows', type: 'parade', desc: 'Streetcar parade kicks off Carnival' },
            { start: '2025-01-18', end: '2025-01-18', name: 'Krewe of Joan of Arc', type: 'parade', desc: 'French Quarter walking parade' },
            { start: '2025-01-20', end: '2025-01-20', name: 'MLK Day Parade', type: 'parade' },

            // FEBRUARY 2025 - MARDI GRAS SEASON
            { start: '2025-02-08', end: '2025-02-08', name: 'Krewe of Oshun', type: 'parade' },
            { start: '2025-02-08', end: '2025-02-08', name: 'Krewe of Cleopatra', type: 'parade' },
            { start: '2025-02-14', end: '2025-02-14', name: 'Krewe of Eve', type: 'parade' },
            { start: '2025-02-14', end: '2025-02-14', name: "Valentine's Day", type: 'event' },
            { start: '2025-02-15', end: '2025-02-15', name: 'Krewe of Pontchartrain', type: 'parade' },
            { start: '2025-02-21', end: '2025-02-21', name: 'Krewe of Nyx', type: 'parade', desc: 'Largest all-female krewe' },
            { start: '2025-02-22', end: '2025-02-22', name: 'Krewe of Endymion', type: 'parade', desc: 'Mega parade - Mid City' },
            { start: '2025-02-23', end: '2025-02-23', name: 'Krewe of Bacchus', type: 'parade', desc: 'Celebrity king parade' },
            { start: '2025-02-24', end: '2025-02-24', name: 'Krewe of Orpheus', type: 'parade', desc: 'Lundi Gras super krewe' },
            { start: '2025-02-25', end: '2025-02-25', name: 'Zulu Parade', type: 'parade', desc: 'Mardi Gras morning - coconuts!' },
            { start: '2025-02-25', end: '2025-02-25', name: 'Rex Parade', type: 'parade', desc: 'King of Carnival' },
            { start: '2025-02-25', end: '2025-02-25', name: 'Mardi Gras Day', type: 'festival', desc: 'Fat Tuesday!' },
            { start: '2025-02-28', end: '2025-03-02', name: 'Buku Music + Art Project', type: 'festival', desc: 'Electronic music festival' },

            // MARCH 2025
            { start: '2025-03-02', end: '2025-03-02', name: 'Lundi Gras Second Line', type: 'secondline' },
            { start: '2025-03-09', end: '2025-03-09', name: "Super Sunday - St. Joseph's", type: 'secondline', desc: 'Mardi Gras Indians' },
            { start: '2025-03-15', end: '2025-03-16', name: 'Irish Channel Parade', type: 'parade', desc: 'Block party on Magazine St' },
            { start: '2025-03-17', end: '2025-03-17', name: "St. Patrick's Day", type: 'event' },
            { start: '2025-03-19', end: '2025-03-19', name: "St. Joseph's Day", type: 'event', desc: 'Italian altars throughout city' },
            { start: '2025-03-21', end: '2025-03-23', name: 'NOLA Pyrate Week', type: 'event' },
            { start: '2025-03-23', end: '2025-03-23', name: 'Second Line (Treme)', type: 'secondline' },
            { start: '2025-03-28', end: '2025-03-30', name: 'Tennessee Williams Festival', type: 'festival' },
            { start: '2025-03-29', end: '2025-03-29', name: 'Chris Owens Easter Parade', type: 'parade' },

            // APRIL 2025
            { start: '2025-04-04', end: '2025-04-06', name: 'Hogs for the Cause', type: 'festival', desc: 'BBQ & music' },
            { start: '2025-04-10', end: '2025-04-13', name: 'French Quarter Festival', type: 'festival', desc: 'Free music throughout FQ' },
            { start: '2025-04-13', end: '2025-04-13', name: 'Second Line (7th Ward)', type: 'secondline' },
            { start: '2025-04-20', end: '2025-04-20', name: 'Second Line (Uptown)', type: 'secondline' },
            { start: '2025-04-25', end: '2025-04-27', name: 'Jazz Fest Weekend 1', type: 'festival', desc: 'New Orleans Jazz & Heritage Festival' },
            { start: '2025-04-27', end: '2025-04-27', name: 'Second Line (Treme)', type: 'secondline' },

            // MAY 2025
            { start: '2025-05-01', end: '2025-05-04', name: 'Jazz Fest Weekend 2', type: 'festival', desc: 'New Orleans Jazz & Heritage Festival' },
            { start: '2025-05-04', end: '2025-05-04', name: 'Second Line (Central City)', type: 'secondline' },
            { start: '2025-05-09', end: '2025-05-11', name: 'Bayou Boogaloo', type: 'festival', desc: 'Free fest on Bayou St. John' },
            { start: '2025-05-11', end: '2025-05-11', name: 'Second Line (7th Ward)', type: 'secondline' },
            { start: '2025-05-16', end: '2025-05-18', name: 'New Orleans Wine & Food', type: 'festival' },
            { start: '2025-05-18', end: '2025-05-18', name: 'Second Line (Uptown)', type: 'secondline' },
            { start: '2025-05-23', end: '2025-05-25', name: 'Greek Festival', type: 'festival' },

            // JUNE 2025
            { start: '2025-06-01', end: '2025-06-01', name: 'Second Line (Treme)', type: 'secondline' },
            { start: '2025-06-06', end: '2025-06-08', name: 'Creole Tomato Festival', type: 'festival', desc: 'French Market' },
            { start: '2025-06-07', end: '2025-06-07', name: 'Pride Parade', type: 'parade' },
            { start: '2025-06-15', end: '2025-06-15', name: 'Second Line (7th Ward)', type: 'secondline' },
            { start: '2025-06-20', end: '2025-06-22', name: 'Oyster Festival', type: 'festival' },
            { start: '2025-06-22', end: '2025-06-22', name: 'Second Line (Central City)', type: 'secondline' },

            // JULY 2025
            { start: '2025-07-03', end: '2025-07-06', name: 'Essence Festival', type: 'festival', desc: 'Biggest party in NOLA' },
            { start: '2025-07-04', end: '2025-07-04', name: 'Go 4th on the River', type: 'event', desc: 'Fireworks on the Mississippi' },
            { start: '2025-07-13', end: '2025-07-13', name: 'Second Line (Uptown)', type: 'secondline' },
            { start: '2025-07-18', end: '2025-07-20', name: 'Tales of the Cocktail', type: 'festival', desc: 'World cocktail conference' },
            { start: '2025-07-20', end: '2025-07-20', name: 'Second Line (Treme)', type: 'secondline' },
            { start: '2025-07-27', end: '2025-07-27', name: 'Second Line (7th Ward)', type: 'secondline' },

            // AUGUST 2025
            { start: '2025-08-01', end: '2025-08-03', name: 'Satchmo SummerFest', type: 'festival', desc: 'Louis Armstrong celebration' },
            { start: '2025-08-02', end: '2025-08-02', name: 'White Linen Night', type: 'event', desc: 'Art walk on Julia St' },
            { start: '2025-08-09', end: '2025-08-09', name: 'Dirty Linen Night', type: 'event', desc: 'Art walk on Royal St' },
            { start: '2025-08-09', end: '2025-08-09', name: 'Red Dress Run', type: 'event', desc: 'Hash House Harriers charity run' },
            { start: '2025-08-10', end: '2025-08-10', name: 'Second Line (Central City)', type: 'secondline' },
            { start: '2025-08-17', end: '2025-08-17', name: 'Second Line (Uptown)', type: 'secondline' },
            { start: '2025-08-22', end: '2025-08-24', name: 'COOLinary Restaurant Weeks', type: 'event', desc: 'Prix fixe dining deals' },
            { start: '2025-08-24', end: '2025-08-24', name: 'Second Line (Treme)', type: 'secondline' },

            // SEPTEMBER 2025
            { start: '2025-09-05', end: '2025-09-07', name: 'Southern Decadence', type: 'festival', desc: 'LGBTQ+ celebration in FQ' },
            { start: '2025-09-07', end: '2025-09-07', name: 'Second Line (7th Ward)', type: 'secondline' },
            { start: '2025-09-14', end: '2025-09-14', name: 'Second Line (Uptown)', type: 'secondline' },
            { start: '2025-09-19', end: '2025-09-21', name: 'Fried Chicken Festival', type: 'festival', desc: 'Free admission!' },
            { start: '2025-09-21', end: '2025-09-21', name: 'Second Line (Central City)', type: 'secondline' },
            { start: '2025-09-28', end: '2025-09-28', name: 'Second Line (Treme)', type: 'secondline' },

            // OCTOBER 2025
            { start: '2025-10-03', end: '2025-10-05', name: 'Crescent City Blues Fest', type: 'festival' },
            { start: '2025-10-05', end: '2025-10-05', name: 'Second Line (7th Ward)', type: 'secondline' },
            { start: '2025-10-10', end: '2025-10-12', name: 'Beignet Festival', type: 'festival' },
            { start: '2025-10-12', end: '2025-10-12', name: 'Second Line (Uptown)', type: 'secondline' },
            { start: '2025-10-17', end: '2025-10-19', name: 'Boudin Bourbon & Beer', type: 'festival' },
            { start: '2025-10-19', end: '2025-10-19', name: 'Second Line (Central City)', type: 'secondline' },
            { start: '2025-10-25', end: '2025-10-27', name: 'Voodoo Music Festival', type: 'festival', desc: 'City Park mega concert' },
            { start: '2025-10-26', end: '2025-10-26', name: 'Krewe of Boo', type: 'parade', desc: 'Halloween parade downtown' },
            { start: '2025-10-31', end: '2025-10-31', name: 'Halloween in the Quarter', type: 'event', desc: 'Costumes on Frenchmen & Bourbon' },

            // NOVEMBER 2025
            { start: '2025-11-02', end: '2025-11-02', name: 'Second Line (Treme)', type: 'secondline' },
            { start: '2025-11-09', end: '2025-11-09', name: 'Second Line (7th Ward)', type: 'secondline' },
            { start: '2025-11-14', end: '2025-11-16', name: 'Oak Street Po-Boy Festival', type: 'festival' },
            { start: '2025-11-16', end: '2025-11-16', name: 'Second Line (Uptown)', type: 'secondline' },
            { start: '2025-11-23', end: '2025-11-23', name: 'Second Line (Central City)', type: 'secondline' },
            { start: '2025-11-27', end: '2025-11-27', name: 'Thanksgiving', type: 'event' },
            { start: '2025-11-28', end: '2025-11-29', name: 'Bayou Classic', type: 'event', desc: 'Grambling vs Southern football' },
            { start: '2025-11-29', end: '2025-11-29', name: 'Celebration in the Oaks', type: 'event', desc: 'Holiday lights - City Park' },

            // DECEMBER 2025
            { start: '2025-12-06', end: '2025-12-06', name: 'Krewe of Jingle', type: 'parade', desc: 'Holiday bike parade' },
            { start: '2025-12-07', end: '2025-12-07', name: 'Second Line (Treme)', type: 'secondline' },
            { start: '2025-12-13', end: '2025-12-14', name: 'LUNA Fete', type: 'event', desc: 'Light art projections downtown' },
            { start: '2025-12-14', end: '2025-12-14', name: 'Second Line (7th Ward)', type: 'secondline' },
            { start: '2025-12-20', end: '2025-12-20', name: 'Caroling in Jackson Square', type: 'event' },
            { start: '2025-12-21', end: '2025-12-21', name: 'Second Line (Uptown)', type: 'secondline' },
            { start: '2025-12-24', end: '2025-12-24', name: 'Christmas Eve Bonfires', type: 'event', desc: 'On the levee in St. James Parish' },
            { start: '2025-12-25', end: '2025-12-25', name: 'Christmas Day', type: 'event' },
            { start: '2025-12-31', end: '2025-12-31', name: 'New Years Eve', type: 'event', desc: 'Fleur de lis drop at Jax Brewery' },

            // =============================================
            // 2026 EVENTS
            // =============================================

            // JANUARY 2026
            { start: '2026-01-01', end: '2026-01-01', name: 'Allstate Sugar Bowl', type: 'event' },
            { start: '2026-01-06', end: '2026-01-06', name: 'King Cake Season Begins', type: 'event' },
            { start: '2026-01-10', end: '2026-01-10', name: 'Phunny Phorty Phellows', type: 'parade' },
            { start: '2026-01-17', end: '2026-01-17', name: 'Krewe of Joan of Arc', type: 'parade' },
            { start: '2026-01-19', end: '2026-01-19', name: 'MLK Day Parade', type: 'parade' },
            { start: '2026-01-25', end: '2026-01-25', name: 'Second Line (Treme)', type: 'secondline' },

            // FEBRUARY 2026 - MARDI GRAS
            { start: '2026-02-01', end: '2026-02-01', name: 'Second Line (7th Ward)', type: 'secondline' },
            { start: '2026-02-06', end: '2026-02-06', name: 'Krewe of Oshun', type: 'parade' },
            { start: '2026-02-07', end: '2026-02-07', name: 'Krewe of Cleopatra', type: 'parade' },
            { start: '2026-02-08', end: '2026-02-08', name: 'Second Line (Uptown)', type: 'secondline' },
            { start: '2026-02-13', end: '2026-02-13', name: 'Krewe of Nyx', type: 'parade' },
            { start: '2026-02-14', end: '2026-02-14', name: 'Krewe of Endymion', type: 'parade', desc: 'Mega parade + Extravaganza' },
            { start: '2026-02-14', end: '2026-02-14', name: "Valentine's Day", type: 'event' },
            { start: '2026-02-15', end: '2026-02-15', name: 'Krewe of Bacchus', type: 'parade' },
            { start: '2026-02-16', end: '2026-02-16', name: 'Krewe of Orpheus', type: 'parade', desc: 'Lundi Gras' },
            { start: '2026-02-17', end: '2026-02-17', name: 'Zulu Parade', type: 'parade', desc: 'Get a coconut!' },
            { start: '2026-02-17', end: '2026-02-17', name: 'Rex Parade', type: 'parade' },
            { start: '2026-02-17', end: '2026-02-17', name: 'Mardi Gras Day', type: 'festival', desc: 'Fat Tuesday!' },
            { start: '2026-02-27', end: '2026-03-01', name: 'Buku Music + Art Project', type: 'festival' },

            // MARCH 2026
            { start: '2026-03-01', end: '2026-03-01', name: 'Super Sunday', type: 'secondline', desc: 'Mardi Gras Indians' },
            { start: '2026-03-14', end: '2026-03-15', name: 'Irish Channel Parade', type: 'parade' },
            { start: '2026-03-17', end: '2026-03-17', name: "St. Patrick's Day", type: 'event' },
            { start: '2026-03-19', end: '2026-03-19', name: "St. Joseph's Day", type: 'event' },
            { start: '2026-03-27', end: '2026-03-29', name: 'Tennessee Williams Festival', type: 'festival' },

            // APRIL 2026
            { start: '2026-04-03', end: '2026-04-05', name: 'Hogs for the Cause', type: 'festival' },
            { start: '2026-04-09', end: '2026-04-12', name: 'French Quarter Festival', type: 'festival', desc: 'Free music throughout FQ' },
            { start: '2026-04-24', end: '2026-04-26', name: 'Jazz Fest Weekend 1', type: 'festival' },

            // MAY 2026
            { start: '2026-05-01', end: '2026-05-03', name: 'Jazz Fest Weekend 2', type: 'festival' },
            { start: '2026-05-08', end: '2026-05-10', name: 'Bayou Boogaloo', type: 'festival' },
            { start: '2026-05-15', end: '2026-05-17', name: 'New Orleans Wine & Food', type: 'festival' },
            { start: '2026-05-22', end: '2026-05-24', name: 'Greek Festival', type: 'festival' },

            // JUNE 2026
            { start: '2026-06-05', end: '2026-06-07', name: 'Creole Tomato Festival', type: 'festival' },
            { start: '2026-06-13', end: '2026-06-13', name: 'Pride Parade', type: 'parade' },
            { start: '2026-06-19', end: '2026-06-21', name: 'Oyster Festival', type: 'festival' },

            // JULY 2026
            { start: '2026-07-02', end: '2026-07-05', name: 'Essence Festival', type: 'festival' },
            { start: '2026-07-04', end: '2026-07-04', name: 'Go 4th on the River', type: 'event' },
            { start: '2026-07-17', end: '2026-07-19', name: 'Tales of the Cocktail', type: 'festival' },

            // AUGUST 2026
            { start: '2026-08-07', end: '2026-08-09', name: 'Satchmo SummerFest', type: 'festival' },
            { start: '2026-08-01', end: '2026-08-01', name: 'White Linen Night', type: 'event' },
            { start: '2026-08-08', end: '2026-08-08', name: 'Dirty Linen Night', type: 'event' },
            { start: '2026-08-08', end: '2026-08-08', name: 'Red Dress Run', type: 'event' },

            // SEPTEMBER 2026
            { start: '2026-09-04', end: '2026-09-06', name: 'Southern Decadence', type: 'festival' },
            { start: '2026-09-18', end: '2026-09-20', name: 'Fried Chicken Festival', type: 'festival' },

            // OCTOBER 2026
            { start: '2026-10-02', end: '2026-10-04', name: 'Crescent City Blues Fest', type: 'festival' },
            { start: '2026-10-09', end: '2026-10-11', name: 'Beignet Festival', type: 'festival' },
            { start: '2026-10-16', end: '2026-10-18', name: 'Boudin Bourbon & Beer', type: 'festival' },
            { start: '2026-10-30', end: '2026-11-01', name: 'Voodoo Music Festival', type: 'festival' },
            { start: '2026-10-25', end: '2026-10-25', name: 'Krewe of Boo', type: 'parade' },
            { start: '2026-10-31', end: '2026-10-31', name: 'Halloween', type: 'event' },

            // NOVEMBER 2026
            { start: '2026-11-13', end: '2026-11-15', name: 'Oak Street Po-Boy Festival', type: 'festival' },
            { start: '2026-11-26', end: '2026-11-26', name: 'Thanksgiving', type: 'event' },
            { start: '2026-11-27', end: '2026-11-28', name: 'Bayou Classic', type: 'event' },
            { start: '2026-11-28', end: '2026-11-28', name: 'Celebration in the Oaks', type: 'event' },

            // DECEMBER 2026
            { start: '2026-12-05', end: '2026-12-05', name: 'Krewe of Jingle', type: 'parade' },
            { start: '2026-12-12', end: '2026-12-13', name: 'LUNA Fete', type: 'event' },
            { start: '2026-12-19', end: '2026-12-19', name: 'Caroling in Jackson Square', type: 'event' },
            { start: '2026-12-24', end: '2026-12-24', name: 'Christmas Eve Bonfires', type: 'event' },
            { start: '2026-12-25', end: '2026-12-25', name: 'Christmas Day', type: 'event' },
            { start: '2026-12-31', end: '2026-12-31', name: 'New Years Eve', type: 'event' },
        ];

        // ============================================
        // EVENTS TICKER INITIALIZATION
        // ============================================
        function initEventsTicker() {
            const tickerTrack = document.getElementById('ticker-track');
            if (!tickerTrack) return;

            // Get upcoming events (next 6 months)
            const today = new Date();
            const sixMonthsLater = new Date(today);
            sixMonthsLater.setMonth(sixMonthsLater.getMonth() + 6);

            const todayStr = today.toISOString().split('T')[0];
            const futureStr = sixMonthsLater.toISOString().split('T')[0];

            const upcomingEvents = nolaEvents
                .filter(event => event.end >= todayStr && event.start <= futureStr)
                .sort((a, b) => a.start.localeCompare(b.start))
                .slice(0, 30); // Limit to 30 events

            if (upcomingEvents.length === 0) return;

            // Format date for display
            function formatTickerDate(startStr, endStr) {
                const start = new Date(startStr + 'T00:00:00');
                const end = new Date(endStr + 'T00:00:00');
                const options = { month: 'short', day: 'numeric' };

                if (startStr === endStr) {
                    return start.toLocaleDateString('en-US', options);
                }
                return `${start.toLocaleDateString('en-US', options)} - ${end.toLocaleDateString('en-US', options)}`;
            }

            // Build ticker content (duplicate for seamless loop)
            let tickerHTML = '';
            for (let i = 0; i < 2; i++) {
                upcomingEvents.forEach(event => {
                    tickerHTML += `
                        <span class="ticker-item">
                            <span class="event-name">${event.name}</span>
                            <span class="separator">¬∑</span>
                            <span class="event-dates">${formatTickerDate(event.start, event.end)}</span>
                        </span>
                    `;
                });
            }

            tickerTrack.innerHTML = tickerHTML;
        }

        // Initialize ticker on page load
        initEventsTicker();

        function getEventsForMonth(year, month) {
            return nolaEvents.filter(event => {
                const start = new Date(event.start);
                const end = new Date(event.end);
                return (start.getFullYear() === year && start.getMonth() === month) ||
                       (end.getFullYear() === year && end.getMonth() === month);
            });
        }

        function getEventsForDate(dateStr) {
            return nolaEvents.filter(event => dateStr >= event.start && dateStr <= event.end);
        }

        function getEventsForRange(startDate, endDate) {
            return nolaEvents.filter(event => {
                return (event.start >= startDate && event.start <= endDate) ||
                       (event.end >= startDate && event.end <= endDate) ||
                       (event.start <= startDate && event.end >= endDate);
            });
        }

        // ============================================
        // CUSTOM CALENDAR - SINGLE MONTH VIEW
        // ============================================
        const calendarContainer = document.getElementById('calendar-container');
        const calendarDays1 = document.getElementById('calendar-days-1');
        const calendarTitle1 = document.getElementById('calendar-title-1');

        let currentMonth = new Date().getMonth();
        let currentYear = new Date().getFullYear();
        let selectingFor = 'check-in';
        let selectedCheckIn = null;
        let selectedCheckOut = null;
        let availabilityData = {}; // Store availability by date
        let availabilityLoaded = false;

        const monthNames = ['January', 'February', 'March', 'April', 'May', 'June',
                           'July', 'August', 'September', 'October', 'November', 'December'];

        // Fetch availability from Guesty
        async function fetchAvailability() {
            if (availabilityLoaded) return;
            try {
                const response = await fetch('/.netlify/functions/get-availability');
                const data = await response.json();

                // Handle both array format and object format from API
                let days = [];
                if (Array.isArray(data)) {
                    days = data;
                } else if (data.days) {
                    days = data.days;
                } else if (typeof data === 'object') {
                    // Convert object with numeric keys to array
                    days = Object.values(data).filter(d => d && d.date);
                }

                if (days.length > 0) {
                    days.forEach(day => {
                        if (day && day.date) {
                            availabilityData[day.date] = {
                                available: day.status === 'available',
                                status: day.status,
                                minNights: day.minNights || 1,
                                price: day.price
                            };
                        }
                    });
                    availabilityLoaded = true;
                    console.log('Availability loaded:', Object.keys(availabilityData).length, 'days');
                    renderCalendar(); // Re-render with availability
                }
            } catch (error) {
                console.log('Could not fetch availability:', error);
            }
        }

        function isDateAvailable(dateStr) {
            if (!availabilityLoaded) return true; // Assume available if not loaded
            const day = availabilityData[dateStr];
            if (!day) return true; // No data means assume available
            return day.status === 'available';
        }

        function renderMonth(container, year, month) {
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const today = new Date();
            today.setHours(0, 0, 0, 0);

            container.innerHTML = '';

            // Empty cells for days before the first
            for (let i = 0; i < firstDay; i++) {
                container.innerHTML += '<div class="calendar-day empty"></div>';
            }

            // Days of the month
            for (let day = 1; day <= daysInMonth; day++) {
                const date = new Date(year, month, day);
                const dateStr = date.toISOString().split('T')[0];
                const events = getEventsForDate(dateStr);
                const isPast = date < today;
                const isAvailable = isDateAvailable(dateStr);
                const isCheckIn = selectedCheckIn === dateStr;
                const isCheckOut = selectedCheckOut === dateStr;
                const isInRange = selectedCheckIn && selectedCheckOut &&
                                  dateStr > selectedCheckIn && dateStr < selectedCheckOut;

                let classes = 'calendar-day';
                if (isPast) classes += ' disabled';
                else if (!isAvailable) classes += ' unavailable';
                if (isCheckIn) classes += ' check-in';
                if (isCheckOut) classes += ' check-out';
                if (isInRange) classes += ' in-range';
                // Only show event indicators on available dates
                if (events.length > 0 && !isPast && isAvailable) {
                    classes += ' has-event';
                    // Add class for highest priority event type
                    if (events.some(e => e.type === 'festival')) classes += ' festival';
                    else if (events.some(e => e.type === 'parade')) classes += ' parade';
                    else if (events.some(e => e.type === 'secondline')) classes += ' secondline';
                    else classes += ' event';
                }

                // Get first event name to display
                let eventNameHtml = '';
                if (events.length > 0 && !isPast && isAvailable) {
                    const shortName = events[0].name.length > 12
                        ? events[0].name.substring(0, 10) + '...'
                        : events[0].name;
                    eventNameHtml = `<span class="event-name-mini">${shortName}</span>`;
                }

                const isClickable = !isPast && isAvailable;
                container.innerHTML += `
                    <div class="${classes}" data-date="${dateStr}" ${isClickable ? `onclick="selectDate('${dateStr}')"` : ''}>
                        <span class="day-number">${day}</span>
                        ${eventNameHtml}
                    </div>
                `;
            }
        }

        function renderCalendar() {
            // Render single month
            calendarTitle1.textContent = `${monthNames[currentMonth]} ${currentYear}`;
            renderMonth(calendarDays1, currentYear, currentMonth);
            renderMarquee();
        }

        function renderMarquee() {
            const marqueeEl = document.getElementById('marquee-events');
            if (!marqueeEl) return;

            // Get upcoming events for next 3 months
            const events = [];
            for (let i = 0; i < 3; i++) {
                let m = currentMonth + i;
                let y = currentYear;
                if (m > 11) { m -= 12; y++; }
                events.push(...getEventsForMonth(y, m));
            }

            // Remove duplicates and sort by date
            const uniqueEvents = events.filter((e, i, arr) =>
                arr.findIndex(x => x.name === e.name && x.start === e.start) === i
            ).sort((a, b) => a.start.localeCompare(b.start)).slice(0, 8);

            if (uniqueEvents.length > 0) {
                marqueeEl.innerHTML = uniqueEvents.map(e => `
                    <div class="marquee-event">
                        <span class="marquee-event-dot ${e.type}"></span>
                        <div class="marquee-event-info">
                            <span class="marquee-event-name">${e.name}</span>
                            <span class="marquee-event-date">${formatEventDates(e.start, e.end)}</span>
                        </div>
                    </div>
                `).join('');
            } else {
                marqueeEl.innerHTML = '<span class="no-events-msg">Check back for upcoming events</span>';
            }
        }

        function updateCalendarInstruction() {
            // Instruction element removed - function kept for compatibility
        }

        function formatEventDates(start, end) {
            const s = new Date(start + 'T00:00:00');
            const e = new Date(end + 'T00:00:00');
            const opts = { month: 'short', day: 'numeric' };
            if (start === end) {
                return s.toLocaleDateString('en-US', opts);
            }
            return `${s.toLocaleDateString('en-US', opts)} - ${e.toLocaleDateString('en-US', opts)}`;
        }

        // Auto-fetch price when both dates selected
        function autoFetchPrice() {
            if (selectedCheckIn && selectedCheckOut) {
                // Trigger price check automatically
                document.getElementById('check-prices-btn').click();
            }
        }

        window.selectDate = function(dateStr) {
            if (selectingFor === 'check-in' || !selectedCheckIn) {
                selectedCheckIn = dateStr;
                selectedCheckOut = null;
                document.getElementById('check-in').value = dateStr;
                document.getElementById('check-out').value = '';
                selectingFor = 'check-out';
            } else {
                if (dateStr <= selectedCheckIn) {
                    // Clicked before check-in, reset to new check-in
                    selectedCheckIn = dateStr;
                    selectedCheckOut = null;
                    document.getElementById('check-in').value = dateStr;
                    document.getElementById('check-out').value = '';
                    selectingFor = 'check-out';
                } else {
                    selectedCheckOut = dateStr;
                    document.getElementById('check-out').value = dateStr;
                    selectingFor = 'check-in';
                    // Auto-fetch price after short delay for visual feedback
                    setTimeout(autoFetchPrice, 300);
                }
            }
            updateCalendarInstruction();
            renderCalendar();
        };

        // Calendar navigation
        document.getElementById('cal-prev').addEventListener('click', () => {
            currentMonth--;
            if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            renderCalendar();
        });

        document.getElementById('cal-next').addEventListener('click', () => {
            currentMonth++;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            }
            renderCalendar();
        });

        // Initialize calendar and prefetch availability
        renderCalendar();
        fetchAvailability();
        updateCalendarInstruction();

        // ============================================
        // BOOKING FUNCTIONALITY
        // ============================================
        const checkInInput = document.getElementById('check-in');
        const checkOutInput = document.getElementById('check-out');
        const guestsSelect = document.getElementById('guests');
        const checkPricesBtn = document.getElementById('check-prices-btn');
        const quoteDisplay = document.getElementById('quote-display');
        const quoteLoading = document.getElementById('quote-loading');
        const quoteResult = document.getElementById('quote-result');
        const quoteError = document.getElementById('quote-error');
        const checkoutContainer = document.getElementById('checkout-container');
        const checkoutSection = document.getElementById('checkout-section');

        // Store quote data
        let currentQuote = null;
        let currentTotal = 0;

        // Update per-guest price when guests change
        guestsSelect.addEventListener('change', () => {
            if (currentTotal > 0) {
                const numGuests = parseInt(guestsSelect.value) || 1;
                const perGuest = Math.round(currentTotal / numGuests);
                document.getElementById('quote-per-guest').textContent = `¬∑ $${perGuest.toLocaleString()}/guest`;
            }
        });

        // Check prices
        checkPricesBtn.addEventListener('click', async () => {
            const checkIn = checkInInput.value;
            const checkOut = checkOutInput.value;
            const guests = guestsSelect.value;

            if (!checkIn || !checkOut) {
                alert('Please select check-in and check-out dates');
                return;
            }

            // Show loading
            quoteDisplay.classList.remove('hidden');
            quoteLoading.classList.remove('hidden');
            quoteResult.classList.add('hidden');
            quoteError.classList.add('hidden');

            try {
                const response = await fetch(`/.netlify/functions/get-quote?checkIn=${checkIn}&checkOut=${checkOut}&guests=${guests}`);
                const data = await response.json();

                if (!response.ok) {
                    throw new Error(data.error || 'Unable to get quote');
                }

                currentQuote = data;
                console.log('Quote response:', JSON.stringify(data, null, 2));

                // Format dates
                const checkInDate = new Date(checkIn + 'T00:00:00');
                const checkOutDate = new Date(checkOut + 'T00:00:00');
                const nights = Math.ceil((checkOutDate - checkInDate) / (1000 * 60 * 60 * 24));

                const dateOptions = { month: 'short', day: 'numeric' };
                const formattedCheckIn = checkInDate.toLocaleDateString('en-US', dateOptions);
                const formattedCheckOut = checkOutDate.toLocaleDateString('en-US', dateOptions);

                // Display quote - try multiple paths to find total
                document.getElementById('quote-dates').textContent = `${formattedCheckIn} - ${formattedCheckOut} ¬∑ ${nights} night${nights > 1 ? 's' : ''}`;

                // Guesty quote response structure: rates.ratePlans[0].ratePlan.money
                const ratePlanData = data.rates?.ratePlans?.[0];
                const money = ratePlanData?.ratePlan?.money;

                // Get total price (hostPayout includes everything guest pays)
                const total = money?.hostPayout || money?.subTotalPrice || 0;
                currentTotal = total; // Store for guest count updates

                console.log('Money object:', money);
                console.log('Extracted total:', total);

                // Store ratePlanId for booking
                if (ratePlanData?.ratePlan?._id) {
                    currentQuote.ratePlanId = ratePlanData.ratePlan._id;
                }
                document.getElementById('quote-total').textContent = `$${Math.round(total).toLocaleString()}`;
                document.getElementById('quote-breakdown').textContent = 'total';

                // Calculate and display per-guest price
                const numGuests = parseInt(guests) || 1;
                const perGuest = Math.round(total / numGuests);
                document.getElementById('quote-per-guest').textContent = `¬∑ $${perGuest.toLocaleString()}/guest`;

                quoteLoading.classList.add('hidden');
                quoteResult.classList.remove('hidden');

                // Auto-show stay info panel and checkout section
                document.getElementById('stay-info-panel').classList.remove('hidden');
                checkoutSection.classList.remove('hidden');
                initializeStripe();
                updateStayInfo();

                // Make banner clickable to scroll to checkout form
                quoteDisplay.onclick = () => {
                    document.getElementById('checkout-card').scrollIntoView({ behavior: 'smooth', block: 'start' });
                };

            } catch (error) {
                console.error('Quote error:', error);
                document.getElementById('quote-error-message').textContent = error.message || 'Unable to get pricing. Please try again.';
                quoteLoading.classList.add('hidden');
                quoteError.classList.remove('hidden');
            }
        });

        // ============================================
        // STRIPE INTEGRATION
        // ============================================
        let stripe, cardElement;

        function initializeStripe() {
            if (stripe) return; // Already initialized

            stripe = Stripe('pk_live_LKZLJ4NxjahxWDx9hYlD2lNm00ZBKE4pVm');
            const elements = stripe.elements();

            cardElement = elements.create('card', {
                style: {
                    base: {
                        fontSize: '16px',
                        color: '#2D2D2D',
                        fontFamily: "'Montserrat', sans-serif",
                        '::placeholder': { color: '#A0A0A0' }
                    }
                }
            });

            cardElement.mount('#card-element');

            cardElement.on('change', (event) => {
                const displayError = document.getElementById('card-errors');
                displayError.textContent = event.error ? event.error.message : '';
            });

            // Populate checkout summary
            const checkIn = checkInInput.value;
            const checkOut = checkOutInput.value;
            const guests = guestsSelect.value;
            const money = currentQuote?.rates?.ratePlans?.[0]?.ratePlan?.money;
            const total = money?.hostPayout || money?.subTotalPrice || 0;

            document.getElementById('checkout-summary').innerHTML = `
                <div class="summary-row">
                    <span>Dates</span>
                    <span>${checkIn} to ${checkOut}</span>
                </div>
                <div class="summary-row">
                    <span>Guests</span>
                    <span>${guests}</span>
                </div>
                <div class="summary-row summary-total">
                    <span>Total</span>
                    <span>$${Math.round(total).toLocaleString()}</span>
                </div>
            `;
        }

        // Weather data by month
        const weatherByMonth = {
            0: { temp: '55¬∞F', desc: 'Cool and crisp with occasional rain. Perfect for exploring the city on foot. Pack layers!' },
            1: { temp: '60¬∞F', desc: 'Mild temperatures as Mardi Gras season heats up. Great weather for parades!' },
            2: { temp: '65¬∞F', desc: 'Beautiful spring weather. Ideal for outdoor dining and festival season.' },
            3: { temp: '72¬∞F', desc: 'Warm and pleasant - peak season for Jazz Fest. Pool weather begins!' },
            4: { temp: '80¬∞F', desc: 'Warm and humid. Perfect for pool days and evening strolls on Magazine Street.' },
            5: { temp: '85¬∞F', desc: 'Hot and humid - embrace it! Great for early morning or evening activities.' },
            6: { temp: '90¬∞F', desc: 'Peak summer heat. Stay cool by the pool during the day, explore at night.' },
            7: { temp: '90¬∞F', desc: 'Hot and steamy. AC and cold drinks are your friends. Pool is essential!' },
            8: { temp: '85¬∞F', desc: 'Still warm with occasional afternoon thunderstorms. Festival season returns!' },
            9: { temp: '75¬∞F', desc: 'Cooling off beautifully. Perfect weather for Voodoo Fest and Halloween.' },
            10: { temp: '65¬∞F', desc: 'Crisp fall air arrives. Ideal for exploring neighborhoods and outdoor dining.' },
            11: { temp: '58¬∞F', desc: 'Cool holiday season. Festive lights and celebrations throughout the city.' }
        };

        // Update stay info panel when checkout opens
        function updateStayInfo() {
            if (!selectedCheckIn || !selectedCheckOut) return;

            const checkInDate = new Date(selectedCheckIn + 'T00:00:00');
            const month = checkInDate.getMonth();

            // Update weather
            const weather = weatherByMonth[month];
            document.getElementById('stay-weather').textContent =
                `Expect temperatures around ${weather.temp}. ${weather.desc}`;

            // Update events
            const events = getEventsForRange(selectedCheckIn, selectedCheckOut);
            const eventsContainer = document.getElementById('stay-events');

            if (events.length > 0) {
                eventsContainer.innerHTML = events.slice(0, 5).map(e => `
                    <div class="stay-event-item ${e.type}">
                        <span class="stay-event-name">${e.name}</span>
                        <span class="stay-event-date">${formatEventDates(e.start, e.end)}</span>
                    </div>
                `).join('');
                if (events.length > 5) {
                    eventsContainer.innerHTML += `<p class="no-events-msg">+ ${events.length - 5} more events</p>`;
                }
            } else {
                eventsContainer.innerHTML = '<p class="no-events-msg">No major events during these dates - enjoy a quieter NOLA experience!</p>';
            }
        }

        // Add-ons calculation
        function updateAddonsTotal() {
            const checkboxes = document.querySelectorAll('.addon-item input[type="checkbox"]');
            let total = 0;
            let selectedAddons = [];

            checkboxes.forEach(cb => {
                if (cb.checked) {
                    total += parseInt(cb.dataset.price);
                    selectedAddons.push(cb.dataset.name);
                }
            });

            const totalEl = document.getElementById('addons-total');
            const amountEl = document.getElementById('addons-total-amount');

            if (total > 0) {
                totalEl.classList.remove('hidden');
                amountEl.textContent = `$${total}`;
            } else {
                totalEl.classList.add('hidden');
            }

            return { total, selectedAddons };
        }

        // Listen for addon changes
        document.querySelectorAll('.addon-item input[type="checkbox"]').forEach(cb => {
            cb.addEventListener('change', updateAddonsTotal);
        });

        // Handle checkout form submission
        const checkoutForm = document.getElementById('checkout-form');
        checkoutForm.addEventListener('submit', async (e) => {
            e.preventDefault();

            const submitBtn = document.getElementById('submit-booking');
            submitBtn.disabled = true;
            submitBtn.textContent = 'Processing...';

            try {
                // Create payment method
                const { paymentMethod, error } = await stripe.createPaymentMethod({
                    type: 'card',
                    card: cardElement,
                    billing_details: {
                        name: `${document.getElementById('guest-first-name').value} ${document.getElementById('guest-last-name').value}`,
                        email: document.getElementById('guest-email').value
                    }
                });

                if (error) {
                    throw new Error(error.message);
                }

                // Create reservation
                const response = await fetch('/.netlify/functions/create-reservation', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        quoteId: currentQuote._id || currentQuote.id,
                        ratePlanId: currentQuote.ratePlanId,
                        ccToken: paymentMethod.id,
                        guest: {
                            firstName: document.getElementById('guest-first-name').value,
                            lastName: document.getElementById('guest-last-name').value,
                            email: document.getElementById('guest-email').value,
                            phone: document.getElementById('guest-phone').value
                        }
                    })
                });

                const result = await response.json();

                if (!response.ok || !result.success) {
                    throw new Error(result.error || 'Reservation failed');
                }

                // Show confirmation
                checkoutContainer.classList.add('hidden');
                document.getElementById('booking-confirmation').classList.remove('hidden');
                document.getElementById('confirmation-details').innerHTML = `
                    <p><strong>Confirmation:</strong> ${result.reservation.confirmationCode || result.reservation._id}</p>
                    <p><strong>Dates:</strong> ${checkInInput.value} to ${checkOutInput.value}</p>
                `;

            } catch (error) {
                console.error('Booking error:', error);
                alert(error.message || 'Unable to complete booking. Please try again.');
                submitBtn.disabled = false;
                submitBtn.textContent = 'Confirm Reservation';
            }
        });

        // ============================================
        // PARALLAX EFFECTS
        // ============================================
        window.addEventListener('scroll', () => {
            const scrolled = window.pageYOffset;

            // Parallax for invitation background
            const invitationBg = document.querySelector('.invitation-bg');
            if (invitationBg) {
                invitationBg.style.transform = `translateY(${scrolled * 0.5}px)`;
            }

            // Parallax for water background
            const waterBg = document.querySelector('.water-bg img');
            if (waterBg) {
                const waterSection = document.querySelector('.scene-water');
                const waterRect = waterSection.getBoundingClientRect();
                if (waterRect.top < window.innerHeight && waterRect.bottom > 0) {
                    const progress = (window.innerHeight - waterRect.top) / (window.innerHeight + waterRect.height);
                    waterBg.style.transform = `translateY(${progress * -100}px) scale(1.1)`;
                }
            }
        }, { passive: true });
    </script>

    <!-- üé≠üëë‚öúÔ∏è MARDI GRAS 100X MODE - ABSOLUTE CHAOS! ‚öúÔ∏èüëëüé≠ -->
    
    <!-- Toggle Button -->
    <button class="mardi-gras-toggle" id="mardi-gras-toggle" title="LAISSEZ LES BONS TEMPS ROULER!">
        <span class="mask-icon">üé≠</span>
        <span class="toggle-text">PARTY MODE</span>
    </button>

    <!-- ALL THE CONTAINERS -->
    <div class="mardi-gras-beads" id="mardi-gras-beads"></div>
    <div class="mardi-gras-confetti" id="mardi-gras-confetti"></div>
    <div class="mardi-gras-streamers" id="mardi-gras-streamers"></div>
    <div class="mardi-gras-fireworks" id="mardi-gras-fireworks"></div>
    <div class="mardi-gras-doubloons" id="mardi-gras-doubloons"></div>
    <div class="floating-masks" id="floating-masks"></div>
    <div class="parade-floats" id="parade-floats"></div>
    <div class="glitter-layer" id="glitter-layer"></div>

    <!-- MEGA BANNER -->
    <div class="mardi-gras-banner" id="mardi-gras-banner">
        <div class="banner-marquee">
            <span>üé≠ LAISSEZ LES BONS TEMPS ROULER! üëë THROW ME SOMETHING MISTER! ‚öúÔ∏è WHO DAT! üé∫ MARDI GRAS 2025! üé∑ HAPPY FAT TUESDAY! üíúüíõüíö </span>
            <span>üé≠ LAISSEZ LES BONS TEMPS ROULER! üëë THROW ME SOMETHING MISTER! ‚öúÔ∏è WHO DAT! üé∫ MARDI GRAS 2025! üé∑ HAPPY FAT TUESDAY! üíúüíõüíö </span>
        </div>
    </div>

    <!-- Corner Chaos -->
    <div class="mardi-corner mardi-corner-tl">üé∫</div>
    <div class="mardi-corner mardi-corner-tr">üé∑</div>
    <div class="mardi-corner mardi-corner-bl">‚öúÔ∏è</div>
    <div class="mardi-corner mardi-corner-br">üëë</div>

    <!-- Bourbon Street Neon Signs -->
    <div class="neon-signs">
        <div class="neon-sign neon-left">BOURBON ST</div>
        <div class="neon-sign neon-right">JAZZ</div>
    </div>

    <!-- King Cake -->
    <div class="king-cake" id="king-cake">üéÇ</div>

    <!-- Second Line Dancers -->
    <div class="second-line" id="second-line"></div>

    <!-- Click Explosion Container -->
    <div class="click-explosions" id="click-explosions"></div>

    <!-- Audio (Jazz Loop) -->
    <audio id="jazz-audio" loop>
        <source src="https://upload.wikimedia.org/wikipedia/commons/e/e5/When_the_Saints_Go_Marching_In_US_Navy_Band.ogg" type="audio/ogg">
    </audio>

    <style>
        /* ============================================
           üé≠ MARDI GRAS 100X - MAXIMUM CHAOS MODE üé≠
           ============================================ */

        /* Custom Cursor */
        body.mardi-gras, body.mardi-gras * {
            cursor: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' viewBox='0 0 32 32'%3E%3Ccircle cx='16' cy='16' r='12' fill='%239C27B0'/%3E%3Ccircle cx='16' cy='16' r='8' fill='%23FFD700'/%3E%3Ccircle cx='16' cy='16' r='4' fill='%234CAF50'/%3E%3C/svg%3E") 16 16, auto !important;
        }

        /* THE DRUNK WOBBLE */
        @keyframes drunk-wobble {
            0%, 100% { transform: rotate(-0.3deg) translateX(-2px); }
            25% { transform: rotate(0.3deg) translateX(2px); }
            50% { transform: rotate(-0.2deg) translateX(-1px); }
            75% { transform: rotate(0.4deg) translateX(1px); }
        }

        body.mardi-gras {
            animation: drunk-wobble 4s ease-in-out infinite;
        }

        /* Screen Flash on Activation */
        @keyframes screen-flash {
            0% { opacity: 1; }
            10% { opacity: 0; background: #9C27B0; }
            20% { opacity: 1; }
            30% { opacity: 0; background: #FFD700; }
            40% { opacity: 1; }
            50% { opacity: 0; background: #4CAF50; }
            60% { opacity: 1; }
            70% { opacity: 0; background: #FFD700; }
            80% { opacity: 1; }
            90% { opacity: 0; background: #9C27B0; }
            100% { opacity: 1; }
        }

        body.mardi-gras.flash-active {
            animation: screen-flash 0.5s ease-out, drunk-wobble 4s ease-in-out infinite 0.5s;
        }

        /* Toggle Button - MEGA */
        .mardi-gras-toggle {
            position: fixed;
            bottom: 20px;
            left: 20px;
            z-index: 10000;
            background: linear-gradient(135deg, #7B2D8E 0%, #1B5E20 25%, #F9A825 50%, #1B5E20 75%, #7B2D8E 100%);
            background-size: 400% 400%;
            border: 4px solid #FFD700;
            border-radius: 50px;
            padding: 18px 30px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.8), 0 0 60px rgba(156, 39, 176, 0.5), 0 0 90px rgba(76, 175, 80, 0.3);
            transition: all 0.3s ease;
            font-family: 'Montserrat', sans-serif;
            animation: button-gradient 2s ease infinite, shake 0.5s ease-in-out infinite;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0) rotate(0); }
            25% { transform: translateX(-3px) rotate(-2deg); }
            75% { transform: translateX(3px) rotate(2deg); }
        }

        @keyframes button-gradient {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .mardi-gras-toggle:hover {
            transform: scale(1.2) rotate(-5deg);
            box-shadow: 0 0 50px rgba(255, 215, 0, 1), 0 0 100px rgba(156, 39, 176, 0.8), 0 0 150px rgba(76, 175, 80, 0.5);
        }

        .mardi-gras-toggle .mask-icon {
            font-size: 2.5em;
            animation: spin-mask 1s ease-in-out infinite;
        }

        @keyframes spin-mask {
            0%, 100% { transform: rotate(-10deg) scale(1); }
            50% { transform: rotate(10deg) scale(1.2); }
        }

        .mardi-gras-toggle .toggle-text {
            color: #FFD700;
            font-size: 0.9em;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: 2px 2px 0 #9C27B0, -2px -2px 0 #4CAF50;
        }

        .mardi-gras-toggle.active {
            animation: mega-button-pulse 0.3s ease-in-out infinite, button-gradient 2s ease infinite;
        }

        @keyframes mega-button-pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        /* MEGA BANNER - Scrolling Marquee */
        .mardi-gras-banner {
            position: fixed;
            top: 32px;
            left: 0;
            right: 0;
            z-index: 1002;
            background: linear-gradient(90deg, #7B2D8E, #9C27B0, #1B5E20, #4CAF50, #F9A825, #FFD700, #7B2D8E);
            background-size: 700% 100%;
            padding: 15px 0;
            transform: translateY(-100%);
            transition: transform 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            box-shadow: 0 5px 30px rgba(0,0,0,0.5), 0 0 50px rgba(255, 215, 0, 0.5);
            animation: banner-gradient 3s linear infinite;
            overflow: hidden;
            border-bottom: 4px solid #FFD700;
        }

        body.mardi-gras .mardi-gras-banner {
            transform: translateY(0);
        }

        .banner-marquee {
            display: flex;
            animation: marquee 15s linear infinite;
            white-space: nowrap;
        }

        .banner-marquee span {
            color: #FFD700;
            font-family: 'Montserrat', sans-serif;
            font-size: 1.3em;
            font-weight: 900;
            letter-spacing: 3px;
            text-shadow: 3px 3px 0 #000, -1px -1px 0 #000, 0 0 20px rgba(255, 215, 0, 0.8);
            padding-right: 50px;
        }

        @keyframes marquee {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }

        @keyframes banner-gradient {
            0% { background-position: 0% 50%; }
            100% { background-position: 700% 50%; }
        }

        /* Neon Signs */
        .neon-signs {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 9990;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        body.mardi-gras .neon-signs {
            opacity: 1;
        }

        .neon-sign {
            position: absolute;
            font-family: 'Montserrat', sans-serif;
            font-size: 2em;
            font-weight: 900;
            padding: 10px 20px;
            border: 3px solid;
            border-radius: 5px;
            animation: neon-flicker 2s ease-in-out infinite;
        }

        .neon-left {
            top: 150px;
            left: 20px;
            color: #ff00ff;
            border-color: #ff00ff;
            text-shadow: 0 0 10px #ff00ff, 0 0 20px #ff00ff, 0 0 40px #ff00ff;
            box-shadow: 0 0 10px #ff00ff, inset 0 0 10px rgba(255, 0, 255, 0.3);
            transform: rotate(-5deg);
        }

        .neon-right {
            top: 200px;
            right: 20px;
            color: #00ffff;
            border-color: #00ffff;
            text-shadow: 0 0 10px #00ffff, 0 0 20px #00ffff, 0 0 40px #00ffff;
            box-shadow: 0 0 10px #00ffff, inset 0 0 10px rgba(0, 255, 255, 0.3);
            transform: rotate(5deg);
            animation-delay: 0.5s;
        }

        @keyframes neon-flicker {
            0%, 100% { opacity: 1; }
            5% { opacity: 0.8; }
            10% { opacity: 1; }
            15% { opacity: 0.6; }
            20% { opacity: 1; }
            80% { opacity: 1; }
            85% { opacity: 0.7; }
            90% { opacity: 1; }
        }

        /* King Cake - Spinning in corner */
        .king-cake {
            position: fixed;
            bottom: 100px;
            right: 30px;
            font-size: 5em;
            z-index: 9991;
            opacity: 0;
            transition: opacity 0.5s ease;
            animation: spin-cake 5s linear infinite, float-cake 2s ease-in-out infinite;
            filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.8));
        }

        body.mardi-gras .king-cake {
            opacity: 1;
        }

        @keyframes spin-cake {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes float-cake {
            0%, 100% { margin-bottom: 0; }
            50% { margin-bottom: 20px; }
        }

        /* Corner Decorations - MEGA */
        .mardi-corner {
            position: fixed;
            font-size: 5em;
            z-index: 9992;
            opacity: 0;
            transition: opacity 0.5s ease;
            pointer-events: none;
            filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.8));
        }

        .mardi-corner-tl { top: 100px; left: 30px; animation: corner-bounce 0.5s ease-in-out infinite; }
        .mardi-corner-tr { top: 100px; right: 30px; animation: corner-bounce 0.5s ease-in-out infinite 0.125s; }
        .mardi-corner-bl { bottom: 200px; left: 30px; animation: corner-bounce 0.5s ease-in-out infinite 0.25s; }
        .mardi-corner-br { bottom: 200px; right: 30px; animation: corner-bounce 0.5s ease-in-out infinite 0.375s; }

        body.mardi-gras .mardi-corner {
            opacity: 1;
        }

        @keyframes corner-bounce {
            0%, 100% { transform: scale(1) rotate(-5deg); }
            50% { transform: scale(1.3) rotate(5deg); }
        }

        /* Glitter Layer */
        .glitter-layer {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 9993;
            opacity: 0;
            transition: opacity 0.5s ease;
            background-image: 
                radial-gradient(2px 2px at 20px 30px, #FFD700, transparent),
                radial-gradient(2px 2px at 40px 70px, #9C27B0, transparent),
                radial-gradient(2px 2px at 50px 160px, #4CAF50, transparent),
                radial-gradient(2px 2px at 90px 40px, #FFD700, transparent),
                radial-gradient(2px 2px at 130px 80px, #9C27B0, transparent),
                radial-gradient(2px 2px at 160px 120px, #4CAF50, transparent);
            background-size: 200px 200px;
            animation: glitter-sparkle 2s linear infinite;
        }

        body.mardi-gras .glitter-layer {
            opacity: 0.6;
        }

        @keyframes glitter-sparkle {
            0% { background-position: 0 0; }
            100% { background-position: 200px 200px; }
        }

        /* Parade Floats */
        .parade-floats {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 150px;
            pointer-events: none;
            z-index: 9989;
            opacity: 0;
            transition: opacity 0.5s ease;
            overflow: hidden;
        }

        body.mardi-gras .parade-floats {
            opacity: 1;
        }

        .parade-float {
            position: absolute;
            bottom: -10px;
            font-size: 6em;
            animation: float-parade linear infinite;
            filter: drop-shadow(0 -5px 20px rgba(255, 215, 0, 0.5));
        }

        @keyframes float-parade {
            0% { transform: translateX(-200px); }
            100% { transform: translateX(calc(100vw + 200px)); }
        }

        /* Second Line Dancers */
        .second-line {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 100px;
            pointer-events: none;
            z-index: 9988;
            opacity: 0;
            transition: opacity 0.5s ease;
            overflow: hidden;
        }

        body.mardi-gras .second-line {
            opacity: 1;
        }

        .dancer {
            position: absolute;
            bottom: 10px;
            font-size: 3em;
            animation: dance linear infinite;
        }

        @keyframes dance {
            0% { transform: translateX(-100px) translateY(0) rotate(-10deg); }
            25% { transform: translateX(calc(25vw - 100px)) translateY(-20px) rotate(10deg); }
            50% { transform: translateX(calc(50vw - 100px)) translateY(0) rotate(-10deg); }
            75% { transform: translateX(calc(75vw - 100px)) translateY(-20px) rotate(10deg); }
            100% { transform: translateX(calc(100vw + 100px)) translateY(0) rotate(-10deg); }
        }

        /* Fireworks */
        .mardi-gras-fireworks {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 9994;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        body.mardi-gras .mardi-gras-fireworks {
            opacity: 1;
        }

        .firework {
            position: absolute;
            width: 5px;
            height: 5px;
            border-radius: 50%;
            animation: explode 1s ease-out forwards;
        }

        .firework-particle {
            position: absolute;
            width: 4px;
            height: 4px;
            border-radius: 50%;
            animation: particle-fly 1s ease-out forwards;
        }

        @keyframes explode {
            0% { transform: scale(0); opacity: 1; }
            100% { transform: scale(50); opacity: 0; }
        }

        @keyframes particle-fly {
            0% { transform: translate(0, 0); opacity: 1; }
            100% { transform: translate(var(--tx), var(--ty)); opacity: 0; }
        }

        /* Click Explosions */
        .click-explosions {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 9999;
        }

        .click-burst {
            position: absolute;
            font-size: 2em;
            animation: burst 0.8s ease-out forwards;
        }

        @keyframes burst {
            0% { transform: scale(0) rotate(0); opacity: 1; }
            100% { transform: scale(2) rotate(180deg) translateY(-100px); opacity: 0; }
        }

        /* Doubloons */
        .mardi-gras-doubloons {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 9995;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        body.mardi-gras .mardi-gras-doubloons {
            opacity: 1;
        }

        .doubloon {
            position: absolute;
            top: -50px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #FFD700 0%, #FFA000 50%, #FFD700 100%);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.8), inset 0 0 10px rgba(0, 0, 0, 0.3);
            animation: fall-doubloon linear forwards;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
        }

        .doubloon::after {
            content: '‚öúÔ∏è';
        }

        @keyframes fall-doubloon {
            0% { transform: translateY(-50px) rotateY(0deg); }
            100% { transform: translateY(105vh) rotateY(1440deg); }
        }

        /* Beads - MAXIMUM */
        .mardi-gras-beads {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9996;
            overflow: hidden;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        body.mardi-gras .mardi-gras-beads {
            opacity: 1;
        }

        .bead {
            position: absolute;
            top: -30px;
            border-radius: 50%;
            animation: fall-bead-crazy linear forwards;
            box-shadow: 0 2px 10px rgba(0,0,0,0.5), inset 0 -3px 6px rgba(0,0,0,0.3), inset 0 3px 6px rgba(255,255,255,0.4);
        }

        .bead.tiny { width: 6px; height: 6px; }
        .bead.small { width: 10px; height: 10px; }
        .bead.medium { width: 16px; height: 16px; }
        .bead.large { width: 24px; height: 24px; }
        .bead.xlarge { width: 32px; height: 32px; }
        .bead.mega { width: 45px; height: 45px; }

        .bead.purple { background: radial-gradient(circle at 30% 30%, #E1BEE7, #9C27B0, #4A148C); }
        .bead.gold { background: radial-gradient(circle at 30% 30%, #FFF59D, #FFD700, #FF8F00); }
        .bead.green { background: radial-gradient(circle at 30% 30%, #A5D6A7, #4CAF50, #1B5E20); }

        @keyframes fall-bead-crazy {
            0% { transform: translateY(-30px) rotate(0deg) translateX(0) scale(1); }
            20% { transform: translateY(20vh) rotate(144deg) translateX(30px) scale(1.1); }
            40% { transform: translateY(40vh) rotate(288deg) translateX(-30px) scale(0.9); }
            60% { transform: translateY(60vh) rotate(432deg) translateX(20px) scale(1.2); }
            80% { transform: translateY(80vh) rotate(576deg) translateX(-20px) scale(0.8); }
            100% { transform: translateY(105vh) rotate(720deg) translateX(0) scale(1); }
        }

        /* Confetti - TONS */
        .mardi-gras-confetti {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9997;
            overflow: hidden;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        body.mardi-gras .mardi-gras-confetti {
            opacity: 1;
        }

        .confetti {
            position: absolute;
            top: -20px;
            animation: fall-confetti-crazy linear forwards;
        }

        .confetti.purple { background: linear-gradient(135deg, #9C27B0, #7B1FA2); }
        .confetti.gold { background: linear-gradient(135deg, #FFD700, #FFA000); }
        .confetti.green { background: linear-gradient(135deg, #4CAF50, #2E7D32); }
        .confetti.pink { background: linear-gradient(135deg, #E91E63, #C2185B); }
        .confetti.blue { background: linear-gradient(135deg, #2196F3, #1565C0); }

        @keyframes fall-confetti-crazy {
            0% { transform: translateY(-20px) rotateX(0deg) rotateY(0deg) rotateZ(0deg); }
            100% { transform: translateY(105vh) rotateX(2000deg) rotateY(1500deg) rotateZ(1000deg); }
        }

        /* Streamers - LOTS */
        .mardi-gras-streamers {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 300px;
            pointer-events: none;
            z-index: 9987;
            overflow: hidden;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        body.mardi-gras .mardi-gras-streamers {
            opacity: 1;
        }

        .streamer {
            position: absolute;
            top: -100px;
            width: 6px;
            border-radius: 3px;
            animation: wave-streamer-crazy 1.5s ease-in-out infinite;
            transform-origin: top center;
        }

        .streamer.purple { background: linear-gradient(180deg, #9C27B0 0%, rgba(156, 39, 176, 0) 100%); }
        .streamer.gold { background: linear-gradient(180deg, #FFD700 0%, rgba(255, 215, 0, 0) 100%); }
        .streamer.green { background: linear-gradient(180deg, #4CAF50 0%, rgba(76, 175, 80, 0) 100%); }

        @keyframes wave-streamer-crazy {
            0%, 100% { transform: rotate(-20deg) scaleY(1); }
            50% { transform: rotate(20deg) scaleY(1.2); }
        }

        /* Floating Masks */
        .floating-masks {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9986;
            overflow: hidden;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        body.mardi-gras .floating-masks {
            opacity: 1;
        }

        .floating-mask {
            position: absolute;
            animation: float-mask-crazy linear infinite;
            filter: drop-shadow(0 0 15px rgba(255, 215, 0, 0.5));
        }

        @keyframes float-mask-crazy {
            0% { transform: translateY(110vh) rotate(0deg) scale(0.5); opacity: 0; }
            10% { opacity: 0.8; }
            90% { opacity: 0.8; }
            100% { transform: translateY(-100px) rotate(720deg) scale(1.5); opacity: 0; }
        }

        /* ============================================
           MARDI GRAS THEME OVERRIDES - 100X MAXIMUM
           ============================================ */
        body.mardi-gras {
            --charcoal: #050208;
            --charcoal-light: #0d0514;
            --olive: #1B5E20;
            --olive-dark: #0a2e0d;
            --olive-light: #2E7D32;
            --cream: #FFF8E1;
            --cream-dark: #FFECB3;
            --coral: #F9A825;
            --coral-light: #FFD54F;
            --white: #ffffff;
            --gray: #7B2D8E;
            --gray-light: #9C27B0;
            --gray-lighter: #CE93D8;
        }

        body.mardi-gras {
            padding-top: 95px !important;
            background: linear-gradient(180deg, #050208 0%, #0d0514 50%, #0a2e0d 100%);
        }

        body.mardi-gras .nav-minimal {
            top: 95px !important;
        }

        /* EVERYTHING GLOWS AND PULSES */
        body.mardi-gras * {
            transition: all 0.3s ease;
        }

        body.mardi-gras section {
            border: 3px solid transparent;
            border-image: linear-gradient(90deg, #9C27B0, #FFD700, #4CAF50, #FFD700, #9C27B0) 1;
            box-shadow: 0 0 50px rgba(156, 39, 176, 0.3), inset 0 0 50px rgba(255, 215, 0, 0.05);
        }

        /* Loader - PARTY HARD */
        body.mardi-gras .loader {
            background: radial-gradient(ellipse at center, #1a0a2e 0%, #050208 100%);
        }

        body.mardi-gras .loader::before {
            content: 'üé≠üé∫‚öúÔ∏èüëëüé∑üé≠üé∫‚öúÔ∏èüëëüé∑';
            position: absolute;
            top: 30%;
            left: 50%;
            transform: translateX(-50%);
            font-size: 2.5em;
            animation: loader-party 0.5s ease-in-out infinite;
        }

        @keyframes loader-party {
            0%, 100% { transform: translateX(-50%) scale(1) rotate(-5deg); }
            50% { transform: translateX(-50%) scale(1.3) rotate(5deg); }
        }

        body.mardi-gras .loader-location {
            color: #FFD700;
            font-size: 1.2em;
            animation: rainbow-flash 0.3s linear infinite;
        }

        @keyframes rainbow-flash {
            0% { color: #FFD700; }
            33% { color: #9C27B0; }
            66% { color: #4CAF50; }
            100% { color: #FFD700; }
        }

        body.mardi-gras .loader-title {
            background: linear-gradient(90deg, #9C27B0, #FFD700, #4CAF50, #FFD700, #9C27B0, #FFD700, #4CAF50);
            background-size: 800% 100%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: ultra-rainbow 1s linear infinite;
        }

        @keyframes ultra-rainbow {
            0% { background-position: 0% 50%; }
            100% { background-position: 800% 50%; }
        }

        body.mardi-gras .loader-line {
            background: linear-gradient(90deg, #9C27B0, #FFD700, #4CAF50, #9C27B0, #FFD700, #4CAF50);
            background-size: 400% 100%;
            animation: line-party 0.5s linear infinite;
            height: 6px;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
        }

        @keyframes line-party {
            0% { background-position: 0% 50%; }
            100% { background-position: 400% 50%; }
        }

        /* Events Ticker - INSANE */
        body.mardi-gras .events-ticker {
            background: linear-gradient(90deg, 
                #7B2D8E, #9C27B0, #E91E63, 
                #1B5E20, #4CAF50, #8BC34A, 
                #F9A825, #FFD700, #FFEB3B,
                #7B2D8E);
            background-size: 1000% 100%;
            animation: ultra-ticker-gradient 3s linear infinite;
            height: 45px;
            border-bottom: 5px solid;
            border-image: linear-gradient(90deg, #FFD700, #9C27B0, #4CAF50, #FFD700) 1;
        }

        @keyframes ultra-ticker-gradient {
            0% { background-position: 0% 50%; }
            100% { background-position: 1000% 50%; }
        }

        body.mardi-gras .ticker-item {
            animation: ticker-bounce 0.5s ease-in-out infinite;
        }

        @keyframes ticker-bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-3px); }
        }

        body.mardi-gras .ticker-item .event-dates {
            color: #FFD700;
            text-shadow: 0 0 15px #FFD700, 0 0 30px #FFD700, 0 0 45px rgba(255, 215, 0, 0.5);
            animation: glow-strobe 0.5s ease-in-out infinite alternate;
        }

        @keyframes glow-strobe {
            from { text-shadow: 0 0 15px #FFD700, 0 0 30px #FFD700; filter: brightness(1); }
            to { text-shadow: 0 0 30px #FFD700, 0 0 60px #FFD700, 0 0 90px #FFD700; filter: brightness(1.5); }
        }

        /* Navigation - NEON OVERLOAD */
        body.mardi-gras .nav-minimal {
            background: linear-gradient(180deg, rgba(5, 2, 8, 0.98) 0%, rgba(13, 5, 20, 0.95) 100%);
            border-bottom: 4px solid;
            border-image: linear-gradient(90deg, #9C27B0, #FFD700, #4CAF50, #FFD700, #9C27B0) 1;
            box-shadow: 0 5px 30px rgba(156, 39, 176, 0.5);
        }

        body.mardi-gras .nav-logo {
            background: linear-gradient(90deg, #FFD700, #FFA000, #FFD700);
            background-size: 200% 100%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gold-shimmer 1s ease infinite;
            filter: drop-shadow(0 0 15px rgba(255, 215, 0, 0.8));
        }

        @keyframes gold-shimmer {
            0%, 100% { background-position: 0% 50%; filter: drop-shadow(0 0 15px rgba(255, 215, 0, 0.8)); }
            50% { background-position: 200% 50%; filter: drop-shadow(0 0 30px rgba(255, 215, 0, 1)); }
        }

        body.mardi-gras .nav-book-btn {
            background: linear-gradient(135deg, #9C27B0 0%, #7B2D8E 50%, #4CAF50 100%);
            background-size: 200% 200%;
            color: #FFD700;
            border: 3px solid #FFD700;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.8), 0 0 40px rgba(156, 39, 176, 0.5), inset 0 0 20px rgba(255, 215, 0, 0.2);
            animation: btn-gradient-fast 1s ease infinite, button-super-glow 0.5s ease-in-out infinite alternate;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        @keyframes btn-gradient-fast {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        @keyframes button-super-glow {
            from { box-shadow: 0 0 20px rgba(255, 215, 0, 0.8), 0 0 40px rgba(156, 39, 176, 0.5); }
            to { box-shadow: 0 0 40px rgba(255, 215, 0, 1), 0 0 80px rgba(156, 39, 176, 0.8), 0 0 120px rgba(76, 175, 80, 0.5); }
        }

        body.mardi-gras .nav-book-btn:hover {
            background: linear-gradient(135deg, #FFD700 0%, #FFA000 100%);
            color: #050208;
            transform: scale(1.2) rotate(5deg);
            box-shadow: 0 0 50px rgba(255, 215, 0, 1), 0 0 100px rgba(255, 215, 0, 0.8);
        }

        /* Invitation - THE GRAND ENTRANCE */
        body.mardi-gras .invitation-overlay {
            background: linear-gradient(180deg,
                rgba(156, 39, 176, 0.6) 0%,
                rgba(123, 45, 142, 0.4) 20%,
                rgba(27, 94, 32, 0.5) 40%,
                rgba(76, 175, 80, 0.3) 60%,
                rgba(249, 168, 37, 0.4) 80%,
                rgba(5, 2, 8, 0.98) 100%
            );
            animation: overlay-pulse 2s ease-in-out infinite;
        }

        @keyframes overlay-pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        body.mardi-gras .invitation-title {
            background: linear-gradient(90deg, 
                #FFD700, #FFA000, #9C27B0, #4CAF50, 
                #FFD700, #FFA000, #9C27B0, #4CAF50);
            background-size: 800% 100%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: ultra-title-rainbow 2s linear infinite;
            filter: drop-shadow(0 0 30px rgba(255, 215, 0, 0.8)) drop-shadow(0 0 60px rgba(156, 39, 176, 0.5));
        }

        @keyframes ultra-title-rainbow {
            0% { background-position: 0% 50%; }
            100% { background-position: 800% 50%; }
        }

        body.mardi-gras .invitation-subtitle {
            color: #CE93D8;
            text-shadow: 0 0 20px #CE93D8, 0 0 40px rgba(156, 39, 176, 0.5);
            animation: subtitle-pulse 1s ease-in-out infinite alternate;
        }

        @keyframes subtitle-pulse {
            from { transform: scale(1); text-shadow: 0 0 20px #CE93D8; }
            to { transform: scale(1.05); text-shadow: 0 0 40px #CE93D8, 0 0 60px rgba(156, 39, 176, 0.8); }
        }

        body.mardi-gras .invitation-location {
            color: #4CAF50;
            text-shadow: 0 0 20px #4CAF50;
            animation: location-glow 1s ease-in-out infinite alternate;
        }

        @keyframes location-glow {
            from { text-shadow: 0 0 20px #4CAF50; }
            to { text-shadow: 0 0 40px #4CAF50, 0 0 60px rgba(76, 175, 80, 0.5); }
        }

        /* Book Section */
        body.mardi-gras .scene-book {
            background: radial-gradient(ellipse at center, #1a0a2e 0%, #050208 100%);
        }

        body.mardi-gras .book-card {
            background: rgba(156, 39, 176, 0.2);
            border: 3px solid;
            border-image: linear-gradient(135deg, #9C27B0, #FFD700, #4CAF50, #FFD700, #9C27B0) 1;
            box-shadow: 0 0 50px rgba(156, 39, 176, 0.4), 0 0 100px rgba(255, 215, 0, 0.2), inset 0 0 30px rgba(255, 215, 0, 0.1);
            animation: card-glow 2s ease-in-out infinite alternate;
        }

        @keyframes card-glow {
            from { box-shadow: 0 0 50px rgba(156, 39, 176, 0.4), 0 0 100px rgba(255, 215, 0, 0.2); }
            to { box-shadow: 0 0 80px rgba(156, 39, 176, 0.6), 0 0 150px rgba(255, 215, 0, 0.4), 0 0 200px rgba(76, 175, 80, 0.2); }
        }

        body.mardi-gras .btn-check-prices {
            background: linear-gradient(90deg, #9C27B0, #FFD700, #4CAF50, #FFD700, #9C27B0);
            background-size: 400% 100%;
            animation: btn-ultra-gradient 1.5s ease infinite;
            border: 3px solid #FFD700;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 3px;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.8);
        }

        @keyframes btn-ultra-gradient {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        body.mardi-gras .btn-check-prices:hover {
            background: #FFD700;
            color: #050208;
            transform: scale(1.15);
            box-shadow: 0 0 60px rgba(255, 215, 0, 1), 0 0 120px rgba(255, 215, 0, 0.5);
        }

        /* All Headings - MEGA GLOW */
        body.mardi-gras h2 {
            background: linear-gradient(90deg, #FFD700, #FFA000, #FFD700, #9C27B0, #FFD700);
            background-size: 500% 100%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: heading-rainbow 3s linear infinite;
            filter: drop-shadow(0 0 25px rgba(255, 215, 0, 0.8));
        }

        @keyframes heading-rainbow {
            0% { background-position: 0% 50%; }
            100% { background-position: 500% 50%; }
        }

        body.mardi-gras h3 {
            color: #CE93D8;
            text-shadow: 0 0 20px #CE93D8, 0 0 40px rgba(156, 39, 176, 0.5);
        }

        body.mardi-gras p {
            color: #FFF8E1;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
        }

        body.mardi-gras .scene-label {
            color: #FFD700;
            text-shadow: 0 0 20px #FFD700, 0 0 40px rgba(255, 215, 0, 0.5);
            letter-spacing: 6px;
            animation: label-glow 1s ease-in-out infinite alternate;
        }

        @keyframes label-glow {
            from { text-shadow: 0 0 20px #FFD700; }
            to { text-shadow: 0 0 40px #FFD700, 0 0 60px rgba(255, 215, 0, 0.8); }
        }

        /* Images - PARTY BORDERS */
        body.mardi-gras .gallery-grid img,
        body.mardi-gras .space-image {
            border: 4px solid;
            border-image: linear-gradient(135deg, #9C27B0, #FFD700, #4CAF50) 1;
            box-shadow: 0 0 30px rgba(156, 39, 176, 0.5), 0 0 60px rgba(255, 215, 0, 0.3);
            animation: image-glow 2s ease-in-out infinite alternate;
        }

        @keyframes image-glow {
            from { box-shadow: 0 0 30px rgba(156, 39, 176, 0.5); }
            to { box-shadow: 0 0 50px rgba(156, 39, 176, 0.7), 0 0 80px rgba(255, 215, 0, 0.5); }
        }

        /* Giant Fleur de Lis */
        body.mardi-gras::before {
            content: '‚öúÔ∏è';
            position: fixed;
            top: 50%;
            right: 50px;
            font-size: 8em;
            transform: translateY(-50%);
            z-index: 1;
            pointer-events: none;
            animation: fleur-mega 1.5s ease-in-out infinite alternate;
            filter: drop-shadow(0 0 30px rgba(255, 215, 0, 0.8)) drop-shadow(0 0 60px rgba(255, 215, 0, 0.5));
        }

        body.mardi-gras::after {
            content: '‚öúÔ∏è';
            position: fixed;
            top: 50%;
            left: 50px;
            font-size: 8em;
            transform: translateY(-50%) scaleX(-1);
            z-index: 1;
            pointer-events: none;
            animation: fleur-mega 1.5s ease-in-out infinite alternate 0.75s;
            filter: drop-shadow(0 0 30px rgba(156, 39, 176, 0.8)) drop-shadow(0 0 60px rgba(156, 39, 176, 0.5));
        }

        @keyframes fleur-mega {
            0% { opacity: 0.5; transform: translateY(-50%) scale(1); }
            100% { opacity: 0.9; transform: translateY(-50%) scale(1.1); }
        }

        /* Scrollbar - PARTY */
        body.mardi-gras::-webkit-scrollbar {
            width: 16px;
        }

        body.mardi-gras::-webkit-scrollbar-track {
            background: linear-gradient(180deg, #050208, #0d0514, #0a2e0d);
        }

        body.mardi-gras::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #9C27B0, #FFD700, #4CAF50, #FFD700, #9C27B0);
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.8);
        }

        /* Links */
        body.mardi-gras a {
            color: #FFD700;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
            transition: all 0.2s ease;
        }

        body.mardi-gras a:hover {
            color: #4CAF50;
            text-shadow: 0 0 20px #4CAF50, 0 0 40px rgba(76, 175, 80, 0.5);
            transform: scale(1.1);
        }

        /* Mobile */
        @media (max-width: 768px) {
            .mardi-gras-toggle {
                bottom: 15px;
                left: 15px;
                padding: 12px 18px;
            }

            .mardi-gras-toggle .toggle-text {
                display: none;
            }

            .mardi-gras-banner {
                padding: 10px 0;
            }

            .banner-marquee span {
                font-size: 0.9em;
            }

            body.mardi-gras::before,
            body.mardi-gras::after {
                font-size: 4em;
                opacity: 0.3;
            }

            .mardi-corner {
                font-size: 3em;
            }

            .neon-sign {
                font-size: 1em;
                padding: 5px 10px;
            }

            .king-cake {
                font-size: 3em;
            }

            body.mardi-gras {
                padding-top: 80px !important;
            }

            body.mardi-gras .nav-minimal {
                top: 80px !important;
            }
        }
    </style>

    <script>
        // üé≠üëë‚öúÔ∏è MARDI GRAS 100X MODE - ABSOLUTE MADNESS! ‚öúÔ∏èüëëüé≠
        const mardiGrasToggle = document.getElementById('mardi-gras-toggle');
        const beadsContainer = document.getElementById('mardi-gras-beads');
        const confettiContainer = document.getElementById('mardi-gras-confetti');
        const streamersContainer = document.getElementById('mardi-gras-streamers');
        const fireworksContainer = document.getElementById('mardi-gras-fireworks');
        const doubloonsContainer = document.getElementById('mardi-gras-doubloons');
        const masksContainer = document.getElementById('floating-masks');
        const paradeContainer = document.getElementById('parade-floats');
        const secondLineContainer = document.getElementById('second-line');
        const clickContainer = document.getElementById('click-explosions');
        const jazzAudio = document.getElementById('jazz-audio');

        let intervals = {};

        const colors = ['purple', 'gold', 'green', 'pink', 'blue'];
        const sizes = ['tiny', 'small', 'medium', 'large', 'xlarge', 'mega'];
        const maskEmojis = ['üé≠', 'üëë', 'üé™', 'üé∫', 'üé∑', '‚öúÔ∏è', 'üÉè', '‚ú®', 'üíú', 'üíõ', 'üíö', 'ü™ò', 'üéµ', 'üé∂', 'ü¶ö', 'üåü', '‚≠ê', 'üîÆ', 'ü™©', 'üé°', 'üé¢', 'üé†'];
        const floatEmojis = ['üöÇ', 'üé™', 'üé†', 'ü¶ö', 'üëë', 'üè∞', 'üêâ', 'ü¶Å', 'üé≠'];
        const dancerEmojis = ['üíÉ', 'üï∫', 'üíÉ', 'üï∫', 'üé∫', 'üé∑', 'ü™ò'];

        function createBead() {
            const bead = document.createElement('div');
            bead.classList.add('bead');
            bead.classList.add(colors[Math.floor(Math.random() * 3)]); // stick to main colors
            bead.classList.add(sizes[Math.floor(Math.random() * sizes.length)]);
            bead.style.left = Math.random() * 100 + 'vw';
            bead.style.animationDuration = (Math.random() * 2 + 2) + 's';
            beadsContainer.appendChild(bead);
            setTimeout(() => bead.remove(), 5000);
        }

        function createConfetti() {
            const confetti = document.createElement('div');
            confetti.classList.add('confetti');
            confetti.classList.add(colors[Math.floor(Math.random() * colors.length)]);
            confetti.style.left = Math.random() * 100 + 'vw';
            confetti.style.animationDuration = (Math.random() * 2 + 3) + 's';
            confetti.style.width = (Math.random() * 12 + 4) + 'px';
            confetti.style.height = (Math.random() * 20 + 8) + 'px';
            confettiContainer.appendChild(confetti);
            setTimeout(() => confetti.remove(), 6000);
        }

        function createDoubloon() {
            const doubloon = document.createElement('div');
            doubloon.classList.add('doubloon');
            doubloon.style.left = Math.random() * 95 + 'vw';
            doubloon.style.animationDuration = (Math.random() * 2 + 3) + 's';
            doubloonsContainer.appendChild(doubloon);
            setTimeout(() => doubloon.remove(), 6000);
        }

        function createMask() {
            const mask = document.createElement('div');
            mask.classList.add('floating-mask');
            mask.textContent = maskEmojis[Math.floor(Math.random() * maskEmojis.length)];
            mask.style.left = Math.random() * 90 + 5 + 'vw';
            mask.style.animationDuration = (Math.random() * 8 + 12) + 's';
            mask.style.fontSize = (Math.random() * 3 + 2) + 'em';
            masksContainer.appendChild(mask);
            setTimeout(() => mask.remove(), 20000);
        }

        function createFirework() {
            const x = Math.random() * window.innerWidth;
            const y = Math.random() * window.innerHeight * 0.5;
            const color = ['#9C27B0', '#FFD700', '#4CAF50', '#E91E63', '#2196F3'][Math.floor(Math.random() * 5)];

            // Create particles
            for (let i = 0; i < 20; i++) {
                const particle = document.createElement('div');
                particle.classList.add('firework-particle');
                particle.style.left = x + 'px';
                particle.style.top = y + 'px';
                particle.style.background = color;
                particle.style.boxShadow = `0 0 10px ${color}`;
                
                const angle = (i / 20) * Math.PI * 2;
                const distance = 100 + Math.random() * 100;
                particle.style.setProperty('--tx', Math.cos(angle) * distance + 'px');
                particle.style.setProperty('--ty', Math.sin(angle) * distance + 'px');

                fireworksContainer.appendChild(particle);
                setTimeout(() => particle.remove(), 1000);
            }
        }

        function createParadeFloat() {
            const float = document.createElement('div');
            float.classList.add('parade-float');
            float.textContent = floatEmojis[Math.floor(Math.random() * floatEmojis.length)];
            float.style.animationDuration = (Math.random() * 10 + 15) + 's';
            paradeContainer.appendChild(float);
            setTimeout(() => float.remove(), 25000);
        }

        function createDancer() {
            const dancer = document.createElement('div');
            dancer.classList.add('dancer');
            dancer.textContent = dancerEmojis[Math.floor(Math.random() * dancerEmojis.length)];
            dancer.style.animationDuration = (Math.random() * 5 + 8) + 's';
            dancer.style.animationDelay = Math.random() * 2 + 's';
            secondLineContainer.appendChild(dancer);
            setTimeout(() => dancer.remove(), 15000);
        }

        function createStreamers() {
            streamersContainer.innerHTML = '';
            const numStreamers = 40;
            for (let i = 0; i < numStreamers; i++) {
                const streamer = document.createElement('div');
                streamer.classList.add('streamer');
                streamer.classList.add(colors[i % 3]);
                streamer.style.left = (i / numStreamers * 100) + '%';
                streamer.style.animationDelay = (Math.random() * 2) + 's';
                streamer.style.height = (Math.random() * 150 + 150) + 'px';
                streamersContainer.appendChild(streamer);
            }
        }

        function clickExplosion(e) {
            if (!document.body.classList.contains('mardi-gras')) return;

            const emojis = ['üé≠', 'üëë', '‚öúÔ∏è', '‚ú®', 'üéâ', 'üíú', 'üíõ', 'üíö', 'üé∫', 'üé∑'];
            for (let i = 0; i < 8; i++) {
                const burst = document.createElement('div');
                burst.classList.add('click-burst');
                burst.textContent = emojis[Math.floor(Math.random() * emojis.length)];
                burst.style.left = e.clientX + 'px';
                burst.style.top = e.clientY + 'px';
                burst.style.transform = `rotate(${Math.random() * 360}deg)`;
                clickContainer.appendChild(burst);
                setTimeout(() => burst.remove(), 800);
            }
        }

        document.addEventListener('click', clickExplosion);

        function startParty() {
            // Screen flash!
            document.body.classList.add('flash-active');
            setTimeout(() => document.body.classList.remove('flash-active'), 500);

            // Try to play jazz (may be blocked by browser)
            try {
                jazzAudio.volume = 0.3;
                jazzAudio.play().catch(() => {});
            } catch(e) {}

            // BEADS - TONS
            intervals.beads = setInterval(createBead, 30);

            // CONFETTI - EVERYWHERE
            intervals.confetti = setInterval(createConfetti, 50);

            // DOUBLOONS
            intervals.doubloons = setInterval(createDoubloon, 500);

            // MASKS
            intervals.masks = setInterval(createMask, 800);

            // FIREWORKS
            intervals.fireworks = setInterval(createFirework, 1500);

            // PARADE
            intervals.parade = setInterval(createParadeFloat, 3000);

            // DANCERS
            intervals.dancers = setInterval(createDancer, 2000);

            // Create initial elements
            for (let i = 0; i < 10; i++) {
                setTimeout(createMask, i * 200);
                setTimeout(createParadeFloat, i * 500);
                setTimeout(createDancer, i * 300);
            }

            // Streamers
            createStreamers();
        }

        function stopParty() {
            try { jazzAudio.pause(); } catch(e) {}

            Object.values(intervals).forEach(interval => clearInterval(interval));
            intervals = {};

            beadsContainer.innerHTML = '';
            confettiContainer.innerHTML = '';
            doubloonsContainer.innerHTML = '';
            masksContainer.innerHTML = '';
            fireworksContainer.innerHTML = '';
            paradeContainer.innerHTML = '';
            secondLineContainer.innerHTML = '';
            streamersContainer.innerHTML = '';
        }

        mardiGrasToggle.addEventListener('click', () => {
            document.body.classList.toggle('mardi-gras');
            mardiGrasToggle.classList.toggle('active');

            if (document.body.classList.contains('mardi-gras')) {
                startParty();
                localStorage.setItem('mardiGrasMode', 'true');
            } else {
                stopParty();
                localStorage.setItem('mardiGrasMode', 'false');
            }
        });

        // Check saved preference
        if (localStorage.getItem('mardiGrasMode') === 'true') {
            document.body.classList.add('mardi-gras');
            mardiGrasToggle.classList.add('active');
            startParty();
        }
    </script>

</body>
</html>
